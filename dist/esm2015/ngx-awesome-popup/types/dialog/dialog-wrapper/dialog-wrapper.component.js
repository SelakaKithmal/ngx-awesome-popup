import { ChangeDetectorRef, Component, ComponentFactoryResolver, ViewChild } from '@angular/core';
import { Observable } from 'rxjs';
import { InsertionDirective } from '../../../core/insertion.directive';
import { fadeInOut } from '../../../core/animations';
import { delay } from 'rxjs/operators';
import { InsertionLoaderDirective } from '../../../core/insertion-loader.directive';
import { DialogClass } from '../core/model';
export class DialogWrapperComponent {
    constructor(dialogBelonging, componentFactoryResolver, cd) {
        this.dialogBelonging = dialogBelonging;
        this.componentFactoryResolver = componentFactoryResolver;
        this.cd = cd;
        this.fadeInOutAnimation = 'open';
        this.showLoader = true;
    }
    ngAfterViewInit() {
        this.loadChildComponent(this.childComponentType);
        this.loadLoaderComponent(this.dialogBelonging.DialogCoreConfig.LoaderComponent);
        this.setDefaultResponse();
        this.cd.detectChanges();
    }
    setDefaultResponse() {
        const dialogResponse = new DialogClass.DialogDefaultResponse();
        dialogResponse.setSuccess(false);
        dialogResponse.setBelonging(this.dialogBelonging);
        this.dialogBelonging.EventsController.setDefaultResponse(dialogResponse);
    }
    ngOnDestroy() {
        if (this.childComponentRef) {
            this.childComponentRef.destroy();
        }
        if (this.loaderComponentRef) {
            this.loaderComponentRef.destroy();
        }
    }
    loadChildComponent(_ComponentType) {
        const componentFactory = this.componentFactoryResolver.resolveComponentFactory(_ComponentType);
        const viewContainerRef = this.insertionPoint.viewContainerRef;
        viewContainerRef.clear();
        this.childComponentRef = viewContainerRef.createComponent(componentFactory);
        this.childComponentRef.instance.dialogBelonging = this.dialogBelonging;
    }
    loadLoaderComponent(_LoaderRef) {
        const componentFactory = this.componentFactoryResolver.resolveComponentFactory(_LoaderRef);
        const viewContainerRef = this.loaderInsertionPoint.viewContainerRef;
        viewContainerRef.clear();
        this.loaderComponentRef = viewContainerRef.createComponent(componentFactory);
    }
    close() {
        this.dialogBelonging.EventsController.close();
    }
    closeParent$(_ClosingAnimation) {
        this.fadeInOutAnimation = _ClosingAnimation;
        const timer = _ClosingAnimation === 'close-slow' ? 1400 : 150;
        return new Observable((observer) => {
            observer.next('');
            observer.complete();
        }).pipe(delay(timer));
    }
    onOverlayClicked(evt) {
        // console.log('onOverlayClicked');
    }
    onCustomButton(_Button) {
        this.dialogBelonging.EventsController.onButtonClick(_Button);
    }
    closeLoader() {
        this.showLoader = false;
    }
}
DialogWrapperComponent.decorators = [
    { type: Component, args: [{
                selector: 'dialog-popup-wrapper',
                template: "<div class=\"ngx-awesome-popup-overlay\" (dblclick)=\"onOverlayClicked($event)\" [@fadeInOut]=\"fadeInOutAnimation\">\n\t\n\t<div class=\"evolve-parent-dialog\"\n\t\t\t[ngClass]=\"{\n          'standard-dialog': dialogBelonging.DialogCoreConfig.LayoutType === 0,\n          'success-dialog': dialogBelonging.DialogCoreConfig.LayoutType === 1,\n          'info-dialog': dialogBelonging.DialogCoreConfig.LayoutType === 2,\n          'warning-dialog': dialogBelonging.DialogCoreConfig.LayoutType === 3,\n          'danger-dialog': dialogBelonging.DialogCoreConfig.LayoutType === 4\n        }\"\n\t>\n\t\t<div class=\"loader-holder\" [ngClass]=\"!dialogBelonging.DialogCoreConfig.DisplayLoader ? 'dialog-loader-off' : (showLoader ? 'dialog-loader-active' : 'dialog-loader-gone')\">\n\t\t\t<!--dialogBelonging.DialogCoreConfig.DisplayLoader => initial config-->\n\t\t\t<div class=\"dialog-loader\">\n\t\t\t\t<ng-template appInsertionLoader></ng-template>\n\t\t\t</div>\n\t\t</div>\n\t\t\n\t\t<div class=\"content-holder\" [ngStyle]=\"{'width': dialogBelonging.DialogCoreConfig.Width, 'height': dialogBelonging.DialogCoreConfig.Height}\">\n\n\t\t\t<!--dialogBelonging.DialogCoreConfig.DisplayLoader => initial config-->\n\t\t\t<div class=\"component-content\" [ngClass]=\"!dialogBelonging.DialogCoreConfig.DisplayLoader ? 'component-content-loader-off' : (showLoader ? 'component-content-preparing' : 'component-content-ready')\">\n\t\t\t\t<ng-template appInsertion></ng-template>\n\t\t\t</div>\n\t\t\t\n\t\t</div>\n\t\t\n\t\t<div class=\"button-holder\">\n\t\t\t<div class=\"button-section\" *ngIf=\"dialogBelonging.Buttons.length > 0\" [ngStyle]=\"{ 'text-align': dialogBelonging.DialogCoreConfig.ButtonPosition }\">\n\t\t\t\t\n\t\t\t\t<button\n\t\t\t\t\t\tclass=\"ed-btn ed-btn-lg\" *ngFor=\"let button of dialogBelonging.Buttons\" (click)=\"onCustomButton(button)\"\n\t\t\t\t\t\t[ngClass]=\"{\n\t\t\t                   '': (button.LayoutType ? (button.LayoutType === 0)  : false),\n                              'ed-btn-success': (button.LayoutType ? (button.LayoutType === 1) : false),\n                              'ed-btn-info': (button.LayoutType ? (button.LayoutType === 2) : false),\n                              'ed-btn-warning': (button.LayoutType ? (button.LayoutType === 3)  : false),\n                              'ed-btn-danger': (button.LayoutType ? (button.LayoutType === 4)  : false),\n                              'ed-btn-dark': (button.LayoutType ? (button.LayoutType === 5)  : false),\n                              'ed-btn-light': (button.LayoutType ? (button.LayoutType === 6)  : false),\n                               'ed-btn-primary': (button.LayoutType ? (button.LayoutType === 7) : false),\n                              'ed-btn-secondary': (button.LayoutType ? (button.LayoutType === 8)  : false),\n                              'ed-btn-link': (button.LayoutType ? (button.LayoutType === 9)  : false)\n                            }\"\n\t\t\t\t>{{button.Label}}</button>\n\t\t\t\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t\n</div>\n",
                animations: [fadeInOut(0, 1)],
                styles: [".ed-btn-sm{font-size:12px;font-weight:400;margin-right:3px;padding:2px 8px}.ed-btn-md{font-size:14px;font-weight:bolder;margin-right:5px;padding:3px 6px}.ed-btn-lg{font-size:16px;font-weight:700;margin-right:5px;padding:4px 10px}.ed-btn{background-color:initial;border:none;border-radius:3px;cursor:pointer;display:inline-block;line-height:1.5;text-align:center;text-decoration:none;-webkit-user-select:none;user-select:none;vertical-align:middle}.ed-btn:hover{color:#989ea5}.ed-btn-check:focus+.ed-btn,.ed-btn:focus{box-shadow:0 0 1px 2px;outline:0}.ed-btn-check:active+.ed-btn,.ed-btn-check:active+.ed-btn:focus,.ed-btn-check:checked+.ed-btn,.ed-btn-check:checked+.ed-btn:focus,.ed-btn.active,.ed-btn.active:focus,.ed-btn:active,.ed-btn:active:focus{box-shadow:0 0 1px 2px}.ed-btn.disabled,.ed-btn:disabled,fieldset:disabled .ed-btn{box-shadow:none;opacity:.6;pointer-events:none}.ed-btn-primary{color:#fbfbfb;background:#ff9e00;border-color:#ff9e00}.ed-btn-primary:hover{color:#fbfbfb;border-color:#ffa81a;background:#ffb133}.ed-btn-check:focus+.ed-btn-primary,.ed-btn-primary:focus{outline:0;box-shadow:0 0 1px 2px #ffa81a}.ed-btn-check:active+.ed-btn-primary,.ed-btn-check:active+.ed-btn-primary:focus,.ed-btn-check:checked+.ed-btn-primary,.ed-btn-check:checked+.ed-btn-primary:focus,.ed-btn-primary.active,.ed-btn-primary.active:focus,.ed-btn-primary:active,.ed-btn-primary:active:focus{box-shadow:0 0 1px 2px #ffa81a}.ed-btn-secondary{color:#343a40;background:#989ea5;border-color:#989ea5}.ed-btn-secondary:hover{color:#343a40;border-color:#a6abb1;background:#b3b8bd}.ed-btn-check:focus+.ed-btn-secondary,.ed-btn-secondary:focus{outline:0;box-shadow:0 0 1px 2px #a6abb1}.ed-btn-check:active+.ed-btn-secondary,.ed-btn-check:active+.ed-btn-secondary:focus,.ed-btn-check:checked+.ed-btn-secondary,.ed-btn-check:checked+.ed-btn-secondary:focus,.ed-btn-secondary.active,.ed-btn-secondary.active:focus,.ed-btn-secondary:active,.ed-btn-secondary:active:focus{box-shadow:0 0 1px 2px #a6abb1}.ed-btn-success{color:#fbfbfb;background:#3caea3;border-color:#3caea3}.ed-btn-success:hover{color:#fbfbfb;border-color:#45bfb3;background:#58c5bb}.ed-btn-check:focus+.ed-btn-success,.ed-btn-success:focus{outline:0;box-shadow:0 0 1px 2px #45bfb3}.ed-btn-check:active+.ed-btn-success,.ed-btn-check:active+.ed-btn-success:focus,.ed-btn-check:checked+.ed-btn-success,.ed-btn-check:checked+.ed-btn-success:focus,.ed-btn-success.active,.ed-btn-success.active:focus,.ed-btn-success:active,.ed-btn-success:active:focus{box-shadow:0 0 1px 2px #45bfb3}.ed-btn-info{color:#fbfbfb;background:#2f8ee5;border-color:#2f8ee5}.ed-btn-info:hover{color:#fbfbfb;border-color:#469ae8;background:#5ca7eb}.ed-btn-check:focus+.ed-btn-info,.ed-btn-info:focus{outline:0;box-shadow:0 0 1px 2px #469ae8}.ed-btn-check:active+.ed-btn-info,.ed-btn-check:active+.ed-btn-info:focus,.ed-btn-check:checked+.ed-btn-info,.ed-btn-check:checked+.ed-btn-info:focus,.ed-btn-info.active,.ed-btn-info.active:focus,.ed-btn-info:active,.ed-btn-info:active:focus{box-shadow:0 0 1px 2px #469ae8}.ed-btn-warning{color:#fbfbfb;background:#ffc107;border-color:#ffc107}.ed-btn-warning:hover{color:#fbfbfb;border-color:#ffc721;background:#ffce3a}.ed-btn-check:focus+.ed-btn-warning,.ed-btn-warning:focus{outline:0;box-shadow:0 0 1px 2px #ffc721}.ed-btn-check:active+.ed-btn-warning,.ed-btn-check:active+.ed-btn-warning:focus,.ed-btn-check:checked+.ed-btn-warning,.ed-btn-check:checked+.ed-btn-warning:focus,.ed-btn-warning.active,.ed-btn-warning.active:focus,.ed-btn-warning:active,.ed-btn-warning:active:focus{box-shadow:0 0 1px 2px #ffc721}.ed-btn-danger{color:#343a40;background:#e46464;border-color:#e46464}.ed-btn-danger:hover{color:#343a40;border-color:#e87a7a;background:#ec8f8f}.ed-btn-check:focus+.ed-btn-danger,.ed-btn-danger:focus{outline:0;box-shadow:0 0 1px 2px #e87a7a}.ed-btn-check:active+.ed-btn-danger,.ed-btn-check:active+.ed-btn-danger:focus,.ed-btn-check:checked+.ed-btn-danger,.ed-btn-check:checked+.ed-btn-danger:focus,.ed-btn-danger.active,.ed-btn-danger.active:focus,.ed-btn-danger:active,.ed-btn-danger:active:focus{box-shadow:0 0 1px 2px #e87a7a}.ed-btn-light{color:#343a40;background:#fbfbfb;border-color:#fbfbfb}.ed-btn-light:hover{color:#343a40;border-color:#fff;background:#fff}.ed-btn-check:focus+.ed-btn-light,.ed-btn-light:focus{outline:0;box-shadow:0 0 1px 2px #fff}.ed-btn-check:active+.ed-btn-light,.ed-btn-check:active+.ed-btn-light:focus,.ed-btn-check:checked+.ed-btn-light,.ed-btn-check:checked+.ed-btn-light:focus,.ed-btn-light.active,.ed-btn-light.active:focus,.ed-btn-light:active,.ed-btn-light:active:focus{box-shadow:0 0 1px 2px #fff}.ed-btn-dark{color:#fbfbfb;background:#343a40;border-color:#343a40}.ed-btn-dark:hover{color:#fbfbfb;border-color:#3f474e;background:#4b545c}.ed-btn-check:focus+.ed-btn-dark,.ed-btn-dark:focus{outline:0;box-shadow:0 0 1px 2px #3f474e}.ed-btn-check:active+.ed-btn-dark,.ed-btn-check:active+.ed-btn-dark:focus,.ed-btn-check:checked+.ed-btn-dark,.ed-btn-check:checked+.ed-btn-dark:focus,.ed-btn-dark.active,.ed-btn-dark.active:focus,.ed-btn-dark:active,.ed-btn-dark:active:focus{box-shadow:0 0 1px 2px #3f474e}.ngx-awesome-popup-overlay{align-items:center;-webkit-backdrop-filter:blur(2px);backdrop-filter:blur(2px);background:rgba(51,32,0,.4);bottom:0;display:flex;flex-direction:column;justify-content:center;left:0;opacity:0;position:fixed;right:0;top:0;z-index:1000}.evolve-confirm-box .text-wrapper-section,.evolve-parent-dialog .text-wrapper-section,.evolve-toast .text-wrapper-section{width:100%}.evolve-confirm-box .text-wrapper-section .text-wrapper,.evolve-parent-dialog .text-wrapper-section .text-wrapper,.evolve-toast .text-wrapper-section .text-wrapper{display:block;text-align:center;width:100%}.evolve-confirm-box .text-wrapper-section .dont-break-out,.evolve-parent-dialog .text-wrapper-section .dont-break-out,.evolve-toast .text-wrapper-section .dont-break-out{-webkit-hyphens:auto;hyphens:auto;overflow-wrap:break-word;white-space:pre-wrap;word-wrap:break-word}.evolve-confirm-box,.evolve-parent-dialog{background:#fbfbfb;border-radius:5px;border-top:7px solid;box-shadow:0 0 4px 1px rgba(0,0,0,.25);display:flex;flex-direction:column;max-height:calc(100vh - 100px);max-width:calc(100vw - 100px);position:relative;vertical-align:bottom}.evolve-confirm-box.standard-dialog,.evolve-parent-dialog.standard-dialog{border-color:transparent;padding:17px 20px 10px}.evolve-confirm-box.success-dialog,.evolve-parent-dialog.success-dialog{border-color:#3caea3}.evolve-confirm-box.info-dialog,.evolve-parent-dialog.info-dialog{border-color:#2f8ee5}.evolve-confirm-box.warning-dialog,.evolve-parent-dialog.warning-dialog{border-color:#ffc107}.evolve-confirm-box.danger-dialog,.evolve-parent-dialog.danger-dialog{border-color:#e46464}.evolve-parent-dialog{padding:20px 20px 10px}.evolve-parent-dialog .component-content{width:100%;height:100%;transition-delay:.4s;transition-timing-function:linear;transition-duration:.4s;transition-property:opacity}.evolve-parent-dialog .component-content-loader-off{transition:none!important;opacity:1!important}.evolve-parent-dialog .component-content-preparing{transition:none!important;opacity:0}.evolve-parent-dialog .component-content-ready{height:100%;opacity:1}.evolve-parent-dialog .dialog-loader{opacity:1}.evolve-parent-dialog .dialog-loader-off{display:none;opacity:0!important}.evolve-parent-dialog .dialog-loader-gone{opacity:0;pointer-events:none}.evolve-parent-dialog .dialog-loader-active{opacity:1}.loader-holder{position:absolute;transition-delay:.4s;transition-timing-function:linear;transition-duration:.4s;transition-property:opacity;opacity:1;justify-content:center;align-items:center;background:#fbfbfb;width:100%;height:100%;margin:-20px}.content-holder,.loader-holder{display:flex;flex-direction:column}.content-holder{overflow:auto}.button-holder{width:100%;display:flex;justify-content:flex-end;flex-direction:column}.button-holder .button-section{margin:20px -20px -10px;border-top:1px solid rgba(152,158,165,.2);background:rgba(222,226,230,.2);padding:5px 20px}"]
            },] }
];
DialogWrapperComponent.ctorParameters = () => [
    { type: DialogClass.DialogBelonging },
    { type: ComponentFactoryResolver },
    { type: ChangeDetectorRef }
];
DialogWrapperComponent.propDecorators = {
    insertionPoint: [{ type: ViewChild, args: [InsertionDirective, { static: true },] }],
    loaderInsertionPoint: [{ type: ViewChild, args: [InsertionLoaderDirective, { static: true },] }]
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGlhbG9nLXdyYXBwZXIuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vbmd4LWF3ZXNvbWUtcG9wdXAvdHlwZXMvZGlhbG9nL2RpYWxvZy13cmFwcGVyL2RpYWxvZy13cmFwcGVyLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQWdCLGlCQUFpQixFQUFFLFNBQVMsRUFBRSx3QkFBd0IsRUFBaUMsU0FBUyxFQUFDLE1BQU0sZUFBZSxDQUFDO0FBQzlJLE9BQU8sRUFBQyxVQUFVLEVBQVcsTUFBTSxNQUFNLENBQUM7QUFDMUMsT0FBTyxFQUFDLGtCQUFrQixFQUFDLE1BQU0sbUNBQW1DLENBQUM7QUFDckUsT0FBTyxFQUFDLFNBQVMsRUFBQyxNQUFNLDBCQUEwQixDQUFDO0FBQ25ELE9BQU8sRUFBQyxLQUFLLEVBQUMsTUFBTSxnQkFBZ0IsQ0FBQztBQUNyQyxPQUFPLEVBQUMsd0JBQXdCLEVBQUMsTUFBTSwwQ0FBMEMsQ0FBQztBQUNsRixPQUFPLEVBQUMsV0FBVyxFQUFDLE1BQU0sZUFBZSxDQUFDO0FBVTFDLE1BQU0sT0FBTyxzQkFBc0I7SUFXL0IsWUFDVyxlQUE0QyxFQUMzQyx3QkFBa0QsRUFDbEQsRUFBcUI7UUFGdEIsb0JBQWUsR0FBZixlQUFlLENBQTZCO1FBQzNDLDZCQUF3QixHQUF4Qix3QkFBd0IsQ0FBMEI7UUFDbEQsT0FBRSxHQUFGLEVBQUUsQ0FBbUI7UUFiakMsdUJBQWtCLEdBQVcsTUFBTSxDQUFDO1FBQ3BDLGVBQVUsR0FBbUIsSUFBSSxDQUFDO0lBY2xDLENBQUM7SUFFRCxlQUFlO1FBQ1gsSUFBSSxDQUFDLGtCQUFrQixDQUFDLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDO1FBQ2pELElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxJQUFJLENBQUMsZUFBZSxDQUFDLGdCQUFnQixDQUFDLGVBQWUsQ0FBQyxDQUFDO1FBQ2hGLElBQUksQ0FB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Qzs7O1lBVE8sV0FBVyxDQXNCeUIsZUFBZTtZQTVCTix3QkFBd0I7WUFBdEQsaUJBQWlCOzs7NkJBd0JuQyxTQUFTLFNBQUMsa0JBQWtCLEVBQUUsRUFBQyxNQUFNLEVBQUUsSUFBSSxFQUFDO21DQUM1QyxTQUFTLFNBQUMsd0JBQXdCLEVBQUUsRUFBQyxNQUFNLEVBQUUsSUFBSSxFQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtBZnRlclZpZXdJbml0LCBDaGFuZ2VEZXRlY3RvclJlZiwgQ29tcG9uZW50LCBDb21wb25lbnRGYWN0b3J5UmVzb2x2ZXIsIENvbXBvbmVudFJlZiwgT25EZXN0cm95LCBUeXBlLCBWaWV3Q2hpbGR9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHtPYnNlcnZhYmxlLCBPYnNlcnZlcn0gZnJvbSAncnhqcyc7XG5pbXBvcnQge0luc2VydGlvbkRpcmVjdGl2ZX0gZnJvbSAnLi4vLi4vLi4vY29yZS9pbnNlcnRpb24uZGlyZWN0aXZlJztcbmltcG9ydCB7ZmFkZUluT3V0fSBmcm9tICcuLi8uLi8uLi9jb3JlL2FuaW1hdGlvbnMnO1xuaW1wb3J0IHtkZWxheX0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuaW1wb3J0IHtJbnNlcnRpb25Mb2FkZXJEaXJlY3RpdmV9IGZyb20gJy4uLy4uLy4uL2NvcmUvaW5zZXJ0aW9uLWxvYWRlci5kaXJlY3RpdmUnO1xuaW1wb3J0IHtEaWFsb2dDbGFzc30gZnJvbSAnLi4vY29yZS9tb2RlbCc7XG5cblxuQENvbXBvbmVudCh7XG4gICAgc2VsZWN0b3IgICA6ICdkaWFsb2ctcG9wdXAtd3JhcHBlcicsXG4gICAgdGVtcGxhdGVVcmw6ICcuL2RpYWxvZy13cmFwcGVyLmNvbXBvbmVudC5odG1sJyxcbiAgICBzdHlsZVVybHMgIDogWycuL2RpYWxvZy13cmFwcGVyLmNvbXBvbmVudC5zY3NzJ10sXG4gICAgYW5pbWF0aW9ucyA6IFtmYWRlSW5PdXQoMCwgMSldXG4gICAgXG59KVxuZXhwb3J0IGNsYXNzIERpYWxvZ1dyYXBwZXJDb21wb25lbnQgaW1wbGVtZW50cyBBZnRlclZpZXdJbml0LCBPbkRlc3Ryb3kge1xuICAgIGZhZGVJbk91dEFuaW1hdGlvbjogc3RyaW5nID0gJ29wZW4nO1xuICAgIHNob3dMb2FkZXI6IGJvb2xlYW4gICAgICAgID0gdHJ1ZTtcbiAgICBcbiAgICBjaGlsZENvbXBvbmVudFJlZjogQ29tcG9uZW50UmVmPGFueT47XG4gICAgY2hpbGRDb21wb25lbnRUeXBlOiBUeXBlPGFueT47XG4gICAgbG9hZGVyQ29tcG9uZW50UmVmOiBDb21wb25lbnRSZWY8YW55PjtcbiAgICBcbiAgICBAVmlld0NoaWxkKEluc2VydGlvbkRpcmVjdGl2ZSwge3N0YXRpYzogdHJ1ZX0pIGluc2VydGlvblBvaW50OiBJbnNlcnRpb25EaXJlY3RpdmU7XG4gICAgQFZpZXdDaGlsZChJbnNlcnRpb25Mb2FkZXJEaXJlY3RpdmUsIHtzdGF0aWM6IHRydWV9KSBsb2FkZXJJbnNlcnRpb25Qb2ludDogSW5zZXJ0aW9uTG9hZGVyRGlyZWN0aXZlO1xuICAgIFxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwdWJsaWMgZGlhbG9nQmVsb25naW5nOiBEaWFsb2dDbGFzcy5EaWFsb2dCZWxvbmdpbmcsXG4gICAgICAgIHByaXZhdGUgY29tcG9uZW50RmFjdG9yeVJlc29sdmVyOiBDb21wb25lbnRGYWN0b3J5UmVzb2x2ZXIsXG4gICAgICAgIHByaXZhdGUgY2Q6IENoYW5nZURldGVjdG9yUmVmXG4gICAgKSB7XG4gICAgfVxuICAgIFxuICAgIG5nQWZ0ZXJWaWV3SW5pdCgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5sb2FkQ2hpbGRDb21wb25lbnQodGhpcy5jaGlsZENvbXBvbmVudFR5cGUpO1xuICAgICAgICB0aGlzLmxvYWRMb2FkZXJDb21wb25lbnQodGhpcy5kaWFsb2dCZWxvbmdpbmcuRGlhbG9nQ29yZUNvbmZpZy5Mb2FkZXJDb21wb25lbnQpO1xuICAgICAgICB0aGlzLnNldERlZmF1bHRSZXNwb25zZSgpO1xuICAgICAgICB0aGlzLmNkLmRldGVjdENoYW5nZXMoKTtcbiAgICB9XG4gICAgXG4gICAgc2V0RGVmYXVsdFJlc3BvbnNlKCk6IHZvaWQge1xuICAgICAgICBjb25zdCBkaWFsb2dSZXNwb25zZSA9IG5ldyBEaWFsb2dDbGFzcy5EaWFsb2dEZWZhdWx0UmVzcG9uc2UoKTtcbiAgICAgICAgZGlhbG9nUmVzcG9uc2Uuc2V0U3VjY2VzcyhmYWxzZSk7XG4gICAgICAgIGRpYWxvZ1Jlc3BvbnNlLnNldEJlbG9uZ2luZyh0aGlzLmRpYWxvZ0JlbG9uZ2luZyk7XG4gICAgICAgIHRoaXMuZGlhbG9nQmVsb25naW5nLkV2ZW50c0NvbnRyb2xsZXIuc2V0RGVmYXVsdFJlc3BvbnNlKGRpYWxvZ1Jlc3BvbnNlKTtcbiAgICB9XG4gICAgXG4gICAgbmdPbkRlc3Ryb3koKTogdm9pZCB7XG4gICAgICAgIGlmICh0aGlzLmNoaWxkQ29tcG9uZW50UmVmKSB7XG4gICAgICAgICAgICB0aGlzLmNoaWxkQ29tcG9uZW50UmVmLmRlc3Ryb3koKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5sb2FkZXJDb21wb25lbnRSZWYpIHtcbiAgICAgICAgICAgIHRoaXMubG9hZGVyQ29tcG9uZW50UmVmLmRlc3Ryb3koKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBcbiAgICBsb2FkQ2hpbGRDb21wb25lbnQoX0NvbXBvbmVudFR5cGU6IFR5cGU8YW55Pik6IHZvaWQge1xuICAgICAgICBcbiAgICAgICAgY29uc3QgY29tcG9uZW50RmFjdG9yeSA9IHRoaXMuY29tcG9uZW50RmFjdG9yeVJlc29sdmVyLnJlc29sdmVDb21wb25lbnRGYWN0b3J5KF9Db21wb25lbnRUeXBlKTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IHZpZXdDb250YWluZXJSZWYgPSB0aGlzLmluc2VydGlvblBvaW50LnZpZXdDb250YWluZXJSZWY7XG4gICAgICAgIHZpZXdDb250YWluZXJSZWYuY2xlYXIoKTtcbiAgICAgICAgXG4gICAgICAgIHRoaXMuY2hpbGRDb21wb25lbnRSZWYgPSB2aWV3Q29udGFpbmVyUmVmLmNyZWF0ZUNvbXBvbmVudChjb21wb25lbnRGYWN0b3J5KTtcbiAgICAgICAgXG4gICAgICAgIHRoaXMuY2hpbGRDb21wb25lbnRSZWYuaW5zdGFuY2UuZGlhbG9nQmVsb25naW5nID0gdGhpcy5kaWFsb2dCZWxvbmdpbmc7XG4gICAgfVxuICAgIFxuICAgIGxvYWRMb2FkZXJDb21wb25lbnQoX0xvYWRlclJlZjogVHlwZTxhbnk+KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGNvbXBvbmVudEZhY3RvcnkgPSB0aGlzLmNvbXBvbmVudEZhY3RvcnlSZXNvbHZlci5yZXNvbHZlQ29tcG9uZW50RmFjdG9yeShfTG9hZGVyUmVmKTtcbiAgICAgICAgY29uc3Qgdmlld0NvbnRhaW5lclJlZiA9IHRoaXMubG9hZGVySW5zZXJ0aW9uUG9pbnQudmlld0NvbnRhaW5lclJlZjtcbiAgICAgICAgdmlld0NvbnRhaW5lclJlZi5jbGVhcigpO1xuICAgICAgICBcbiAgICAgICAgdGhpcy5sb2FkZXJDb21wb25lbnRSZWYgPSB2aWV3Q29udGFpbmVyUmVmLmNyZWF0ZUNvbXBvbmVudChjb21wb25lbnRGYWN0b3J5KTtcbiAgICB9XG4gICAgXG4gICAgY2xvc2UoKSB7XG4gICAgICAgIFxuICAgICAgICB0aGlzLmRpYWxvZ0JlbG9uZ2luZy5FdmVudHNDb250cm9sbGVyLmNsb3NlKCk7XG4gICAgfVxuICAgIFxuICAgIGNsb3NlUGFyZW50JChfQ2xvc2luZ0FuaW1hdGlvbjogc3RyaW5nKTogT2JzZXJ2YWJsZTxhbnk+IHtcbiAgICAgICAgdGhpcy5mYWRlSW5PdXRBbmltYXRpb24gPSBfQ2xvc2luZ0FuaW1hdGlvbjtcbiAgICAgICAgY29uc3QgdGltZXIgICAgICAgICAgICAgPSBfQ2xvc2luZ0FuaW1hdGlvbiA9PT0gJ2Nsb3NlLXNsb3cnID8gMTQwMCA6IDE1MDtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiBuZXcgT2JzZXJ2YWJsZSgob2JzZXJ2ZXI6IE9ic2VydmVyPGFueT4pID0+IHtcbiAgICAgICAgICAgIG9ic2VydmVyLm5leHQoJycpO1xuICAgICAgICAgICAgb2JzZXJ2ZXIuY29tcGxldGUoKTtcbiAgICAgICAgfSkucGlwZShkZWxheSh0aW1lcikpO1xuICAgIH1cbiAgICBcbiAgICBvbk92ZXJsYXlDbGlja2VkKGV2dDogTW91c2VFdmVudCk6IHZvaWQge1xuICAgICAgICAvLyBjb25zb2xlLmxvZygnb25PdmVybGF5Q2xpY2tlZCcpO1xuICAgIH1cbiAgICBcbiAgICBvbkN1c3RvbUJ1dHRvbihfQnV0dG9uOiBhbnkpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5kaWFsb2dCZWxvbmdpbmcuRXZlbnRzQ29udHJvbGxlci5vbkJ1dHRvbkNsaWNrKF9CdXR0b24pO1xuICAgIH1cbiAgICBcbiAgICBjbG9zZUxvYWRlcigpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5zaG93TG9hZGVyID0gZmFsc2U7XG4gICAgfVxuICAgIFxufVxuIl19