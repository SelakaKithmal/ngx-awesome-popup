import { Subject } from 'rxjs';
import { map } from 'rxjs/operators';
import { GlobalClass } from '../../../core/global';
import { ServiceLocator } from '../../../locator.service';
import { DialogConfigService } from './dialog-config.service';
import { DialogService } from './dialog.service';
export var DialogClass;
(function (DialogClass) {
    // region *** Public ***
    class DialogInitializer {
        constructor(component) {
            this.component = component;
            this.dialogCarrier = new DialogClass.DialogCarrier();
            this.dialogCarrier.setComponent(this.component);
        }
        /** Generic method accept expected payload from dynamic child component.*/
        openDialog$() {
            return this.dialogCarrier.openDialog$().pipe(map(resp => {
                const basicDialogResponse = new DialogResponse();
                const dataControl = new GlobalClass.DataControl();
                dataControl.copyValuesFrom(resp, basicDialogResponse);
                return basicDialogResponse;
            }));
        }
        /** It accepts list of custom buttons */
        setButtons(_Buttons) {
            this.dialogCarrier.setButtons(_Buttons);
        }
        setCustomData(_CustomData) {
            this.dialogCarrier.setCustomData(_CustomData);
        }
        setConfig(_DialogConfig) {
            this.dialogCarrier.setConfig(_DialogConfig);
        }
    }
    DialogClass.DialogInitializer = DialogInitializer;
    class DialogResponse extends GlobalClass.DataControl {
        constructor() {
            super();
            // private Response: DialogPrepareResponse            = new DialogPrepareResponse();
            this.Payload = null;
            this.Success = null;
            this.ClickedButtonID = null;
        }
        /**
         * @ignore
         */
        setPayload(_Payload) {
            this.Payload = _Payload;
        }
        /**
         * @ignore
         */
        setClickedButtonID(_ClickedButtonID) {
            this.ClickedButtonID = _ClickedButtonID;
        }
    }
    DialogClass.DialogResponse = DialogResponse;
    class DialogEventsController {
        constructor(EntityUniqueID) {
            this.EntityUniqueID = EntityUniqueID;
            this._afterClosed = new Subject();
            this.afterClosed$ = this._afterClosed.asObservable();
            this._afterLoader = new Subject();
            this.afterLoader$ = this._afterLoader.asObservable();
            this._onButtonClick = new Subject();
            this.onButtonClick$ = this._onButtonClick.asObservable();
            this._buttonList = new Subject();
            this.buttonList$ = this._buttonList.asObservable();
        }
        close(_Payload = null) {
            this.defaultResponse.setPayload(_Payload);
            this._afterClosed.next(this.defaultResponse);
        }
        onButtonClick(_Button) {
            this.defaultResponse.setClickedButtonID(_Button.ID);
            this._onButtonClick.next(_Button);
        }
        setButtonList(_ButtonList) {
            this._buttonList.next(_ButtonList);
        }
        closeLoader() {
            setTimeout(() => {
                this._afterLoader.next(this.EntityUniqueID);
            }, 0);
        }
        setDefaultResponse(_Response) {
            this.defaultResponse = _Response;
        }
    }
    DialogClass.DialogEventsController = DialogEventsController;
    // endregion
    class DialogDefaultResponse extends DialogResponse {
        constructor() {
            super();
            this.DialogBelonging = null;
        }
        setBelonging(_DialogBelonging) {
            this.DialogBelonging = _DialogBelonging;
        }
    }
    DialogClass.DialogDefaultResponse = DialogDefaultResponse;
    class DialogCarrier {
        constructor() {
            this.dialogBelonging = new DialogBelonging();
        }
        setComponent(_Component) {
            this.component = _Component;
        }
        setButtons(_Buttons) {
            if (_Buttons.length) {
                this.dialogBelonging.Buttons = _Buttons;
            }
        }
        setCustomData(_CustomData) {
            this.dialogBelonging.CustomData = _CustomData;
        }
        setConfig(_DialogConfig) {
            // region *** local UserConfig (defined on place where dialog is called) ***
            const dataControl = new GlobalClass.DataControl();
            dataControl.copyValuesFrom(_DialogConfig, this.dialogBelonging.DialogCoreConfig);
            if (_DialogConfig === null || _DialogConfig === void 0 ? void 0 : _DialogConfig.LoaderComponent) {
                this.dialogBelonging.DialogCoreConfig.DisplayLoader = true;
            }
            // endregion
        }
        openDialog$() {
            const service = ServiceLocator.injector.get(DialogService);
            const dialogController = service.open(this.component, this.dialogBelonging);
            return dialogController.afterClosed$;
        }
    }
    DialogClass.DialogCarrier = DialogCarrier;
    class DialogCoreConfig {
        constructor() {
            this.Width = null;
            this.Height = null;
            this.ButtonPosition = null;
            this.LayoutType = null;
            this.DisplayLoader = null;
            this.LoaderComponent = null;
        }
    }
    DialogClass.DialogCoreConfig = DialogCoreConfig;
    class DialogSettings {
        constructor() {
            this.Buttons = [];
            this.DialogCoreConfig = new DialogCoreConfig();
        }
    }
    DialogClass.DialogSettings = DialogSettings;
    class DialogBelonging extends DialogSettings {
        constructor() {
            super();
            /** @internal */
            this.EntityUniqueID = 'D' + Math.random().toString(36).substr(2, 9);
            this.CustomData = null;
            this.EventsController = new DialogEventsController(this.EntityUniqueID);
            const dialogConfigurator = ServiceLocator.injector.get(DialogConfigService);
            const baseSettings = new DialogSettings();
            const dataControl = new GlobalClass.DataControl();
            dataControl.copyValuesFrom(dialogConfigurator.productionConfig.DialogCoreConfig, baseSettings.DialogCoreConfig);
            this.DialogCoreConfig = baseSettings.DialogCoreConfig;
            this.Buttons = dialogConfigurator.productionConfig.Buttons.slice();
        }
    }
    DialogClass.DialogBelonging = DialogBelonging;
})(DialogClass || (DialogClass = {}));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibW9kZWwuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9uZ3gtYXdlc29tZS1wb3B1cC90eXBlcy9kaWFsb2cvY29yZS9tb2RlbC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFDQSxPQUFPLEVBQWEsT0FBTyxFQUFDLE1BQU0sTUFBTSxDQUFDO0FBQ3pDLE9BQU8sRUFBQyxHQUFHLEVBQUMsTUFBTSxnQkFBZ0IsQ0FBQztBQUVuQyxPQUFPLEVBQUMsV0FBVyxFQUFrQixNQUFNLHNCQUFzQixDQUFDO0FBQ2xFLE9BQU8sRUFBQyxjQUFjLEVBQUMsTUFBTSwwQkFBMEIsQ0FBQztBQUN4RCxPQUFPLEVBQUMsbUJBQW1CLEVBQUMsTUFBTSx5QkFBeUIsQ0FBQztBQUM1RCxPQUFPLEVBQUMsYUFBYSxFQUFDLE1BQU0sa0JBQWtCLENBQUM7QUFpRy9DLE1BQU0sS0FBVyxXQUFXLENBb00zQjtBQXBNRCxXQUFpQixXQUFXO0lBRTNCLHdCQUF3QjtJQUV4QixNQUFhLGlCQUFpQjtRQUk3QixZQUFvQixTQUFvQjtZQUFwQixjQUFTLEdBQVQsU0FBUyxDQUFXO1lBRmhDLGtCQUFhLEdBQWtCLElBQUksV0FBVyxDQUFDLGFBQWEsRUFBRSxDQUFDO1lBR3RFLElBQUksQ0FBQyxhQUFhLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQztRQUNqRCxDQUFDO1FBRUQsMEVBQTBFO1FBQzFFLFdBQVc7WUFDVixPQUFPLElBQUksQ0FBQyxhQUFhLENBQUMsV0FBVyxFQUFFLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsRUFBRTtnQkFDdkQsTUFBTSxtQkFBbUIsR0FBRyxJQUFJLGNBQWMsRUFBRSxDQUFDO2dCQUNqRCxNQUFNLFdBQVcsR0FBVyxJQUFJLFdBQVcsQ0FBQyxXQUFXLEVBQUUsQ0FBQztnQkFDMUQsV0FBVyxDQUFDLGNBQWMsQ0FBQyxJQUFJLEVBQUUsbUJBQW1CLENBQUMsQ0FBQztn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LENBQUMsV0FBVyxFQUFFLENBQUM7WUFDOUUsV0FBVyxDQUFDLGNBQWMsQ0FBQyxrQkFBa0IsQ0FBQyxnQkFBZ0IsQ0FBQyxnQkFBZ0IsRUFBRSxZQUFZLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztZQUNoSCxJQUFJLENBQUMsZ0JBQWdCLEdBQUcsWUFBWSxDQUFDLGdCQUFnQixDQUFDO1lBQ3RELElBQUksQ0FBQyxPQUFPLEdBQVksa0JBQWtCLENBQUMsZ0JBQWdCLENBQUMsT0FBTyxDQUFDLEtBQUssRUFBRSxDQUFDO1FBQzdFLENBQUM7S0FFRDtJQW5CWSwyQkFBZSxrQkFtQjNCLENBQUE7QUFDRixDQUFDLEVBcE1nQixXQUFXLEtBQVgsV0FBVyxRQW9NM0IiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1R5cGV9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHtPYnNlcnZhYmxlLCBTdWJqZWN0fSBmcm9tICdyeGpzJztcbmltcG9ydCB7bWFwfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5pbXBvcnQge0RpYWxvZ0xheW91dERpc3BsYXksIFZlcnRpY2FsUG9zaXRpb259IGZyb20gJy4uLy4uLy4uL2NvcmUvZW51bXMnO1xuaW1wb3J0IHtHbG9iYWxDbGFzcywgR2xvYmFsSW50ZXJmYWNlfSBmcm9tICcuLi8uLi8uLi9jb3JlL2dsb2JhbCc7XG5pbXBvcnQge1NlcnZpY2VMb2NhdG9yfSBmcm9tICcuLi8uLi8uLi9sb2NhdG9yLnNlcnZpY2UnO1xuaW1wb3J0IHtEaWFsb2dDb25maWdTZXJ2aWNlfSBmcm9tICcuL2RpYWxvZy1jb25maWcuc2VydmljZSc7XG5pbXBvcnQge0RpYWxvZ1NlcnZpY2V9IGZyb20gJy4vZGlhbG9nLnNlcnZpY2UnO1xuXG5leHBvcnQgbmFtZXNwYWNlIERpYWxvZ0ludGVyZmFjZSB7XG5cblx0LyoqXG5cdCAqIENoZWNrIGludGVyZmFjZSBvZiBwcm9wZXJ0aWVzLlxuXHQgKi9cblx0ZXhwb3J0IGludGVyZmFjZSBJRGlhbG9nVXNlckNvbmZpZyB7XG5cdFx0QnV0dG9ucz86IEdsb2JhbEludGVyZmFjZS5JQnV0dG9uW107XG5cdFx0RGlhbG9nQ29yZUNvbmZpZz86IERpYWxvZ0ludGVyZmFjZS5JRGlhbG9nQ29yZUNvbmZpZztcblx0fVxuXG5cdC8qKlxuXHQgKiBPcHRpb25hbCB1c2VyIGNvbmZpZ3VyYXRpb24uXG5cdCAqXG5cdCAqIEV4YW1wbGU6XG5cdCAqIGBgYHR5cGVzY3JpcHRcblx0ICogLy8gRGlhbG9nIGNvcmUgY29uZmlnIG9iamVjdCBleGFtcGxlLlxuXHQgKiBjb25zdCBkaWFsb2dDb3JlQ29uZmlnID0ge1xuXHQgKiAgICAgRGlhbG9nQ29yZUNvbmZpZzoge1xuXHQgKiAgICAgICAgV2lkdGggICAgICAgICA6ICc1MDBweCcsXG5cdCAqICAgICAgICBIZWlnaHQgICAgICAgIDogJzUwMHB4Jyxcblx0ICogICAgICAgIEJ1dHRvblBvc2l0aW9uOiAncmlnaHQnLFxuXHQgKiAgICAgICAgTGF5b3V0VHlwZTogRGlhbG9nTGF5b3V0RGlzcGxheS5JTkZPLFxuXHQgKiAgICAgICAgTG9hZGVyQ29tcG9uZW50OiAvLyBBbnkgQW5ndWxhciBjb21wb25lbnQgY2xhc3MgbmFtZSBjYW4gYmUgaW5jbHVkZWQgYXMgYSBsb2FkZXIuXG5cdCAqICAgICAgICBEaXNwbGF5TG9hZGVyOiBmYWxzZSAvLyBUaGlzIHdpbGwgb3ZlcnJpZGUgTG9hZGVyQ29tcG9uZW50LlxuXHQgKiAgICAgfVxuXHQgKiAgfVxuXHQgKiBgYGBcblx0ICovXG5cdGV4cG9ydCBpbnRlcmZhY2UgSURpYWxvZ0NvcmVDb25maWcge1xuXHRcdC8qKiBGaXhlZCBwb3B1cCB3aWR0aCAqL1xuXHRcdFdpZHRoPzogc3RyaW5nO1xuXHRcdC8qKiBGaXhlZCBwb3B1cCBoZWlnaHQgKi9cblx0XHRIZWlnaHQ/OiBzdHJpbmc7XG5cdFx0QnV0dG9uUG9zaXRpb24/OiBWZXJ0aWNhbFBvc2l0aW9uO1xuXHRcdExheW91dFR5cGU/OiBEaWFsb2dMYXlvdXREaXNwbGF5O1xuXHRcdERpc3BsYXlMb2FkZXI/OiBib29sZWFuO1xuXHRcdExvYWRlckNvbXBvbmVudD86IFR5cGU8YW55Pjtcblx0fVxuXG5cdGV4cG9ydCBpbnRlcmZhY2UgSURpYWxvZ0JlbG9uZ2luZyB7XG5cdFx0QnV0dG9uczogR2xvYmFsSW50ZXJmYWNlLklCdXR0b25bXTtcblx0XHREaWFsb2dDb3JlQ29uZmlnOiBEaWFsb2dJbnRlcmZhY2UuSURpYWxvZ0NvcmVDb25maWc7XG5cdFx0RW50aXR5VW5pcXVlSUQ6IHN0cmluZztcblx0XHRDdXN0b21EYXRhOiBhbnk7XG5cdFx0RXZlbnRzQ29udHJvbGxlcjogRGlhbG9nSW50ZXJmYWNlLklEaWFsb2dFdmVudHNDb250cm9sbGVyO1xuXHR9XG5cblx0ZXhwb3J0IGludGVyZmFjZSBJRGlhbG9nRXZlbnRzQ29udHJvbGxlciB7XG5cdFx0LyoqIEBpbnRlcm5hbCAqL1xuXHRcdGRlZmF1bHRSZXNwb25zZTogRGlhbG9nSW50ZXJmYWNlLklQcml2YXRlUmVzcG9uc2VNZXJnZWQ7XG5cdFx0LyoqIEBpbnRlcm5hbCAqL1xuXHRcdGFmdGVyQ2xvc2VkJDogT2JzZXJ2YWJsZTxEaWFsb2dJbnRlcmZhY2UuSVByaXZhdGVSZXNwb25zZU1lcmdlZD47XG5cdFx0LyoqIEBpbnRlcm5hbCAqL1xuXHRcdGFmdGVyTG9hZGVyJDogT2JzZXJ2YWJsZTxzdHJpbmc+O1xuXHRcdC8qKiBAaW50ZXJuYWwgKi9cblx0XHRvbkJ1dHRvbkNsaWNrJDogT2JzZXJ2YWJsZTxHbG9iYWxJbnRlcmZhY2UuSUJ1dHRvbj47XG5cdFx0LyoqIEBpbnRlcm5hbCAqL1xuXHRcdGJ1dHRvbkxpc3QkOiBPYnNlcnZhYmxlPEdsb2JhbEludGVyZmFjZS5JQnV0dG9uW10+O1xuXG5cdFx0Y2xvc2UoX1BheWxvYWQ/OiBhbnkpOiB2b2lkO1xuXG5cdFx0b25CdXR0b25DbGljayhfQnV0dG9uOiBHbG9iYWxJbnRlcmZhY2UuSUJ1dHRvbik6IHZvaWQ7XG5cblx0XHRzZXRCdXR0b25MaXN0KF9CdXR0b25MaXN0OiBHbG9iYWxJbnRlcmZhY2UuSUJ1dHRvbltdKTogdm9pZDtcblxuXHRcdGNsb3NlTG9hZGVyKCk6IHZvaWQ7XG5cblx0XHRzZXREZWZhdWx0UmVzcG9uc2UoX1Jlc3BvbnNlOiBEaWFsb2dJbnRlcmZhY2UuSVByaXZhdGVSZXNwb25zZU1lcmdlZCk6IHZvaWQ7XG5cblx0XHRzZXREZWZhdWx0UmVzcG9uc2UoX1Jlc3BvbnNlOiBEaWFsb2dJbnRlcmZhY2UuSVByaXZhdGVSZXNwb25zZU1lcmdlZCk6IHZvaWQ7XG5cdH1cblxuXHRleHBvcnQgaW50ZXJmYWNlIElEaWFsb2dSZXNwb25zZSB7XG5cblx0XHRzZXRQYXlsb2FkKF9QYXlsb2FkOiBhbnkpOiB2b2lkO1xuXG5cdFx0c2V0Q2xpY2tlZEJ1dHRvbklEKF9DbGlja2VkQnV0dG9uSUQpOiB2b2lkO1xuXG5cdH1cblxuXHRleHBvcnQgaW50ZXJmYWNlIElEaWFsb2dQdWJsaWNSZXNwb25zZTxSZXNwb25zZVBheWxvYWQ+IHtcblx0XHQvKiogR2VuZXJpYyBwcm9wZXJ0eSB0eXBlLCBhY2NlcHQgZXhwZWN0ZWQgcGF5bG9hZCBmcm9tIGR5bmFtaWMgY2hpbGQgY29tcG9uZW50LiAqL1xuXHRcdFBheWxvYWQ6IFJlc3BvbnNlUGF5bG9hZDtcblx0XHRTdWNjZXNzOiBib29sZWFuO1xuXHRcdENsaWNrZWRCdXR0b25JRDogc3RyaW5nXG5cdH1cblxuXHRleHBvcnQgaW50ZXJmYWNlIElQcml2YXRlUmVzcG9uc2VNZXJnZWQgZXh0ZW5kcyBJRGlhbG9nUmVzcG9uc2UsIEdsb2JhbEludGVyZmFjZS5JUHJpdmF0ZVJlc3BvbnNlIHtcblxuXHRcdERpYWxvZ0JlbG9uZ2luZzogRGlhbG9nSW50ZXJmYWNlLklEaWFsb2dCZWxvbmdpbmc7XG5cdH1cblxuXG59XG5cbmV4cG9ydCBuYW1lc3BhY2UgRGlhbG9nQ2xhc3Mge1xuXG5cdC8vIHJlZ2lvbiAqKiogUHVibGljICoqKlxuXG5cdGV4cG9ydCBjbGFzcyBEaWFsb2dJbml0aWFsaXplciB7XG5cblx0XHRwcml2YXRlIGRpYWxvZ0NhcnJpZXI6IERpYWxvZ0NhcnJpZXIgPSBuZXcgRGlhbG9nQ2xhc3MuRGlhbG9nQ2FycmllcigpO1xuXG5cdFx0Y29uc3RydWN0b3IocHJpdmF0ZSBjb21wb25lbnQ6IFR5cGU8YW55Pikge1xuXHRcdFx0dGhpcy5kaWFsb2dDYXJyaWVyLnNldENvbXBvbmVudCh0aGlzLmNvbXBvbmVudCk7XG5cdFx0fVxuXG5cdFx0LyoqIEdlbmVyaWMgbWV0aG9kIGFjY2VwdCBleHBlY3RlZCBwYXlsb2FkIGZyb20gZHluYW1pYyBjaGlsZCBjb21wb25lbnQuKi9cblx0XHRvcGVuRGlhbG9nJDxSZXNwb25zZVBheWxvYWQgPSBhbnk+KCk6IE9ic2VydmFibGU8RGlhbG9nSW50ZXJmYWNlLklEaWFsb2dQdWJsaWNSZXNwb25zZTxSZXNwb25zZVBheWxvYWQ+PiB7XG5cdFx0XHRyZXR1cm4gdGhpcy5kaWFsb2dDYXJyaWVyLm9wZW5EaWFsb2ckKCkucGlwZShtYXAocmVzcCA9PiB7XG5cdFx0XHRcdGNvbnN0IGJhc2ljRGlhbG9nUmVzcG9uc2UgPSBuZXcgRGlhbG9nUmVzcG9uc2UoKTtcblx0XHRcdFx0Y29uc3QgZGF0YUNvbnRyb2wgICAgICAgICA9IG5ldyBHbG9iYWxDbGFzcy5EYXRhQ29udHJvbCgpO1xuXHRcdFx0XHRkYXRhQ29udHJvbC5jb3B5VmFsdWVzRnJvbShyZXNwLCBiYXNpY0RpYWxvZ1Jlc3BvbnNlKTtcblx0XHRcdFx0cmV0dXJuIGJhc2ljRGlhbG9nUmVzcG9uc2U7XG5cdFx0XHR9KSk7XG5cdFx0fVxuXG5cdFx0LyoqIEl0IGFjY2VwdHMgbGlzdCBvZiBjdXN0b20gYnV0dG9ucyAqL1xuXHRcdHNldEJ1dHRvbnMoX0J1dHRvbnM6IEdsb2JhbEludGVyZmFjZS5JQnV0dG9uW10pOiB2b2lkIHtcblx0XHRcdHRoaXMuZGlhbG9nQ2Fycmllci5zZXRCdXR0b25zKF9CdXR0b25zKTtcblx0XHR9XG5cblx0XHRzZXRDdXN0b21EYXRhKF9DdXN0b21EYXRhOiBhbnkpIHtcblx0XHRcdHRoaXMuZGlhbG9nQ2Fycmllci5zZXRDdXN0b21EYXRhKF9DdXN0b21EYXRhKTtcblx0XHR9XG5cblx0XHRzZXRDb25maWcoX0RpYWxvZ0NvbmZpZzogRGlhbG9nSW50ZXJmYWNlLklEaWFsb2dDb3JlQ29uZmlnKSB7XG5cdFx0XHR0aGlzLmRpYWxvZ0NhcnJpZXIuc2V0Q29uZmlnKF9EaWFsb2dDb25maWcpO1xuXHRcdH1cblxuXHR9XG5cblx0ZXhwb3J0IGNsYXNzIERpYWxvZ1Jlc3BvbnNlIGV4dGVuZHMgR2xvYmFsQ2xhc3MuRGF0YUNvbnRyb2wgaW1wbGVtZW50cyBEaWFsb2dJbnRlcmZhY2UuSURpYWxvZ1Jlc3BvbnNlLCBEaWFsb2dJbnRlcmZhY2UuSURpYWxvZ1B1YmxpY1Jlc3BvbnNlPGFueT4ge1xuXHRcdC8vIHByaXZhdGUgUmVzcG9uc2U6IERpYWxvZ1ByZXBhcmVSZXNwb25zZSAgICAgICAgICAgID0gbmV3IERpYWxvZ1ByZXBhcmVSZXNwb25zZSgpO1xuXG5cdFx0UGF5bG9hZDogYW55ICAgICAgICAgICAgPSBudWxsO1xuXHRcdFN1Y2Nlc3M6IGJvb2xlYW4gICAgICAgID0gbnVsbDtcblx0XHRDbGlja2VkQnV0dG9uSUQ6IHN0cmluZyA9IG51bGw7XG5cblx0XHRjb25zdHJ1Y3RvcigpIHtcblx0XHRcdHN1cGVyKCk7XG5cdFx0fVxuXG5cdFx0LyoqXG5cdFx0ICogQGlnbm9yZVxuXHRcdCAqL1xuXHRcdHNldFBheWxvYWQoX1BheWxvYWQ6IGFueSk6IHZvaWQge1xuXHRcdFx0dGhpcy5QYXlsb2FkID0gX1BheWxvYWQ7XG5cdFx0fVxuXG5cdFx0LyoqXG5cdFx0ICogQGlnbm9yZVxuXHRcdCAqL1xuXHRcdHNldENsaWNrZWRCdXR0b25JRChfQ2xpY2tlZEJ1dHRvbklEKTogdm9pZCB7XG5cdFx0XHR0aGlzLkNsaWNrZWRCdXR0b25JRCA9IF9DbGlja2VkQnV0dG9uSUQ7XG5cdFx0fVxuXG5cdH1cblxuXHRleHBvcnQgY2xhc3MgRGlhbG9nRXZlbnRzQ29udHJvbGxlciBpbXBsZW1lbnRzIERpYWxvZ0ludGVyZmFjZS5JRGlhbG9nRXZlbnRzQ29udHJvbGxlciB7XG5cblx0XHRkZWZhdWx0UmVzcG9uc2U6IERpYWxvZ0ludGVyZmFjZS5JUHJpdmF0ZVJlc3BvbnNlTWVyZ2VkO1xuXG5cdFx0cHJpdmF0ZSByZWFkb25seSBfYWZ0ZXJDbG9zZWQ6IFN1YmplY3Q8RGlhbG9nSW50ZXJmYWNlLklQcml2YXRlUmVzcG9uc2VNZXJnZWQ+ID0gbmV3IFN1YmplY3Q8RGlhbG9nSW50ZXJmYWNlLklQcml2YXRlUmVzcG9uc2VNZXJnZWQ+KCk7XG5cdFx0YWZ0ZXJDbG9zZWQkOiBPYnNlcnZhYmxlPERpYWxvZ0ludGVyZmFjZS5JUHJpdmF0ZVJlc3BvbnNlTWVyZ2VkPiAgICAgICAgICAgICAgID0gdGhpcy5fYWZ0ZXJDbG9zZWQuYXNPYnNlcnZhYmxlKCk7XG5cblx0XHRwcml2YXRlIHJlYWRvbmx5IF9hZnRlckxvYWRlcjogYW55ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA9IG5ldyBTdWJqZWN0PHN0cmluZz4oKTtcblx0XHRhZnRlckxvYWRlciQ6IE9ic2VydmFibGU8c3RyaW5nPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA9IHRoaXMuX2FmdGVyTG9hZGVyLmFzT2JzZXJ2YWJsZSgpO1xuXHRcdHByaXZhdGUgcmVhZG9ubHkgX29uQnV0dG9uQ2xpY2s6IFN1YmplY3Q8R2xvYmFsSW50ZXJmYWNlLklCdXR0b24+ID0gbmV3IFN1YmplY3Q8R2xvYmFsSW50ZXJmYWNlLklCdXR0b24+KCk7XG5cdFx0b25CdXR0b25DbGljayQ6IE9ic2VydmFibGU8R2xvYmFsSW50ZXJmYWNlLklCdXR0b24+ICAgICAgICAgICAgICAgPSB0aGlzLl9vbkJ1dHRvbkNsaWNrLmFzT2JzZXJ2YWJsZSgpO1xuXHRcdHByaXZhdGUgcmVhZG9ubHkgX2J1dHRvbkxpc3Q6IFN1YmplY3Q8R2xvYmFsSW50ZXJmYWNlLklCdXR0b25bXT4gID0gbmV3IFN1YmplY3Q8R2xvYmFsSW50ZXJmYWNlLklCdXR0b25bXT4oKTtcblx0XHRidXR0b25MaXN0JDogT2JzZXJ2YWJsZTxHbG9iYWxJbnRlcmZhY2UuSUJ1dHRvbltdPiAgICAgICAgICAgICAgICA9IHRoaXMuX2J1dHRvbkxpc3QuYXNPYnNlcnZhYmxlKCk7XG5cblx0XHRjb25zdHJ1Y3Rvcihwcml2YXRlIEVudGl0eVVuaXF1ZUlEOiBzdHJpbmcpIHtcblx0XHR9XG5cblx0XHRjbG9zZShfUGF5bG9hZDogYW55ID0gbnVsbCk6IHZvaWQge1xuXHRcdFx0dGhpcy5kZWZhdWx0UmVzcG9uc2Uuc2V0UGF5bG9hZChfUGF5bG9hZCk7XG5cdFx0XHR0aGlzLl9hZnRlckNsb3NlZC5uZXh0KHRoaXMuZGVmYXVsdFJlc3BvbnNlKTtcblx0XHR9XG5cblx0XHRvbkJ1dHRvbkNsaWNrKF9CdXR0b246IEdsb2JhbEludGVyZmFjZS5JQnV0dG9uKTogdm9pZCB7XG5cdFx0XHR0aGlzLmRlZmF1bHRSZXNwb25zZS5zZXRDbGlja2VkQnV0dG9uSUQoX0J1dHRvbi5JRCk7XG5cdFx0XHR0aGlzLl9vbkJ1dHRvbkNsaWNrLm5leHQoX0J1dHRvbik7XG5cdFx0fVxuXG5cdFx0c2V0QnV0dG9uTGlzdChfQnV0dG9uTGlzdDogR2xvYmFsSW50ZXJmYWNlLklCdXR0b25bXSk6IHZvaWQge1xuXHRcdFx0dGhpcy5fYnV0dG9uTGlzdC5uZXh0KF9CdXR0b25MaXN0KTtcblx0XHR9XG5cblx0XHRjbG9zZUxvYWRlcigpOiB2b2lkIHtcblx0XHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0XHR0aGlzLl9hZnRlckxvYWRlci5uZXh0KHRoaXMuRW50aXR5VW5pcXVlSUQpO1xuXHRcdFx0fSwgMCk7XG5cblx0XHR9XG5cblx0XHRzZXREZWZhdWx0UmVzcG9uc2UoX1Jlc3BvbnNlOiBEaWFsb2dJbnRlcmZhY2UuSVByaXZhdGVSZXNwb25zZU1lcmdlZCk6IHZvaWQge1xuXHRcdFx0dGhpcy5kZWZhdWx0UmVzcG9uc2UgPSBfUmVzcG9uc2U7XG5cdFx0fVxuXHR9XG5cblx0Ly8gZW5kcmVnaW9uXG5cblx0ZXhwb3J0IGNsYXNzIERpYWxvZ0RlZmF1bHRSZXNwb25zZSBleHRlbmRzIERpYWxvZ1Jlc3BvbnNlIGltcGxlbWVudHMgRGlhbG9nSW50ZXJmYWNlLklQcml2YXRlUmVzcG9uc2VNZXJnZWQge1xuXHRcdERpYWxvZ0JlbG9uZ2luZzogRGlhbG9nSW50ZXJmYWNlLklEaWFsb2dCZWxvbmdpbmcgPSBudWxsO1xuXG5cdFx0Y29uc3RydWN0b3IoKSB7XG5cdFx0XHRzdXBlcigpO1xuXHRcdH1cblxuXHRcdHNldEJlbG9uZ2luZyhfRGlhbG9nQmVsb25naW5nKTogdm9pZCB7XG5cdFx0XHR0aGlzLkRpYWxvZ0JlbG9uZ2luZyA9IF9EaWFsb2dCZWxvbmdpbmc7XG5cdFx0fVxuXG5cdH1cblxuXHRleHBvcnQgY2xhc3MgRGlhbG9nQ2FycmllciB7XG5cblx0XHRkaWFsb2dCZWxvbmdpbmc6IERpYWxvZ0JlbG9uZ2luZyA9IG5ldyBEaWFsb2dCZWxvbmdpbmcoKTtcblx0XHRwcml2YXRlIGNvbXBvbmVudDogVHlwZTxhbnk+O1xuXG5cdFx0Y29uc3RydWN0b3IoKSB7XG5cdFx0fVxuXG5cdFx0c2V0Q29tcG9uZW50KF9Db21wb25lbnQ6IFR5cGU8YW55Pik6IHZvaWQge1xuXHRcdFx0dGhpcy5jb21wb25lbnQgPSBfQ29tcG9uZW50O1xuXHRcdH1cblxuXHRcdHNldEJ1dHRvbnMoX0J1dHRvbnM6IEdsb2JhbEludGVyZmFjZS5JQnV0dG9uW10pIHtcblx0XHRcdGlmIChfQnV0dG9ucy5sZW5ndGgpIHtcblx0XHRcdFx0dGhpcy5kaWFsb2dCZWxvbmdpbmcuQnV0dG9ucyA9IF9CdXR0b25zO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHNldEN1c3RvbURhdGEoX0N1c3RvbURhdGE6IGFueSkge1xuXHRcdFx0dGhpcy5kaWFsb2dCZWxvbmdpbmcuQ3VzdG9tRGF0YSA9IF9DdXN0b21EYXRhO1xuXHRcdH1cblxuXHRcdHNldENvbmZpZyhfRGlhbG9nQ29uZmlnOiBEaWFsb2dJbnRlcmZhY2UuSURpYWxvZ0NvcmVDb25maWcpIHtcblx0XHRcdC8vIHJlZ2lvbiAqKiogbG9jYWwgVXNlckNvbmZpZyAoZGVmaW5lZCBvbiBwbGFjZSB3aGVyZSBkaWFsb2cgaXMgY2FsbGVkKSAqKipcblx0XHRcdGNvbnN0IGRhdGFDb250cm9sID0gbmV3IEdsb2JhbENsYXNzLkRhdGFDb250cm9sKCk7XG5cdFx0XHRkYXRhQ29udHJvbC5jb3B5VmFsdWVzRnJvbShfRGlhbG9nQ29uZmlnLCB0aGlzLmRpYWxvZ0JlbG9uZ2luZy5EaWFsb2dDb3JlQ29uZmlnKTtcblx0XHRcdGlmIChfRGlhbG9nQ29uZmlnPy5Mb2FkZXJDb21wb25lbnQpIHtcblx0XHRcdFx0dGhpcy5kaWFsb2dCZWxvbmdpbmcuRGlhbG9nQ29yZUNvbmZpZy5EaXNwbGF5TG9hZGVyID0gdHJ1ZTtcblx0XHRcdH1cblx0XHRcdC8vIGVuZHJlZ2lvblxuXHRcdH1cblxuXHRcdG9wZW5EaWFsb2ckKCk6IE9ic2VydmFibGU8RGlhbG9nSW50ZXJmYWNlLklQcml2YXRlUmVzcG9uc2VNZXJnZWQ+IHtcblx0XHRcdGNvbnN0IHNlcnZpY2U6IERpYWxvZ1NlcnZpY2UgPSBTZXJ2aWNlTG9jYXRvci5pbmplY3Rvci5nZXQoRGlhbG9nU2VydmljZSk7XG5cdFx0XHRjb25zdCBkaWFsb2dDb250cm9sbGVyICAgICAgID0gc2VydmljZS5vcGVuKHRoaXMuY29tcG9uZW50LCB0aGlzLmRpYWxvZ0JlbG9uZ2luZyk7XG5cdFx0XHRyZXR1cm4gZGlhbG9nQ29udHJvbGxlci5hZnRlckNsb3NlZCQ7XG5cdFx0fVxuXG5cdH1cblxuXHRleHBvcnQgY2xhc3MgRGlhbG9nQ29yZUNvbmZpZyBpbXBsZW1lbnRzIERpYWxvZ0ludGVyZmFjZS5JRGlhbG9nQ29yZUNvbmZpZyB7XG5cdFx0V2lkdGg6IHN0cmluZyAgICAgICAgICAgICAgICAgICAgPSBudWxsO1xuXHRcdEhlaWdodDogc3RyaW5nICAgICAgICAgICAgICAgICAgID0gbnVsbDtcblx0XHRCdXR0b25Qb3NpdGlvbjogVmVydGljYWxQb3NpdGlvbiA9IG51bGw7XG5cdFx0TGF5b3V0VHlwZTogRGlhbG9nTGF5b3V0RGlzcGxheSAgPSBudWxsO1xuXHRcdERpc3BsYXlMb2FkZXI6IGJvb2xlYW4gICAgICAgICAgID0gbnVsbDtcblx0XHRMb2FkZXJDb21wb25lbnQ6IFR5cGU8YW55PiAgICAgICA9IG51bGw7XG5cdH1cblxuXHRleHBvcnQgY2xhc3MgRGlhbG9nU2V0dGluZ3Mge1xuXHRcdEJ1dHRvbnM6IEdsb2JhbEludGVyZmFjZS5JQnV0dG9uW10gICAgICAgICAgICAgICAgICA9IFtdO1xuXHRcdERpYWxvZ0NvcmVDb25maWc6IERpYWxvZ0ludGVyZmFjZS5JRGlhbG9nQ29yZUNvbmZpZyA9IG5ldyBEaWFsb2dDb3JlQ29uZmlnKCk7XG5cdH1cblxuXHRleHBvcnQgY2xhc3MgRGlhbG9nQmVsb25naW5nPEN1c3RvbURhdGEgPSBhbnk+IGV4dGVuZHMgRGlhbG9nU2V0dGluZ3MgaW1wbGVtZW50cyBEaWFsb2dJbnRlcmZhY2UuSURpYWxvZ0JlbG9uZ2luZyB7XG5cblx0XHQvKiogQGludGVybmFsICovXG5cdFx0RW50aXR5VW5pcXVlSUQ6IHN0cmluZyA9ICdEJyArIE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cigyLCA5KTtcblxuXHRcdEN1c3RvbURhdGE6IEN1c3RvbURhdGEgPSBudWxsO1xuXHRcdEV2ZW50c0NvbnRyb2xsZXI6IERpYWxvZ0ludGVyZmFjZS5JRGlhbG9nRXZlbnRzQ29udHJvbGxlcjtcblxuXHRcdGNvbnN0cnVjdG9yKCkge1xuXHRcdFx0c3VwZXIoKTtcblx0XHRcdHRoaXMuRXZlbnRzQ29udHJvbGxlciAgICAgICAgICAgICAgICAgICAgICAgICA9IG5ldyBEaWFsb2dFdmVudHNDb250cm9sbGVyKHRoaXMuRW50aXR5VW5pcXVlSUQpO1xuXHRcdFx0Y29uc3QgZGlhbG9nQ29uZmlndXJhdG9yOiBEaWFsb2dDb25maWdTZXJ2aWNlID0gU2VydmljZUxvY2F0b3IuaW5qZWN0b3IuZ2V0KERpYWxvZ0NvbmZpZ1NlcnZpY2UpO1xuXHRcdFx0Y29uc3QgYmFzZVNldHRpbmdzICAgICAgICAgICAgICAgICAgICAgICAgICAgID0gbmV3IERpYWxvZ1NldHRpbmdzKCk7XG5cdFx0XHRjb25zdCBkYXRhQ29udHJvbCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPSBuZXcgR2xvYmFsQ2xhc3MuRGF0YUNvbnRyb2woKTtcblx0XHRcdGRhdGFDb250cm9sLmNvcHlWYWx1ZXNGcm9tKGRpYWxvZ0NvbmZpZ3VyYXRvci5wcm9kdWN0aW9uQ29uZmlnLkRpYWxvZ0NvcmVDb25maWcsIGJhc2VTZXR0aW5ncy5EaWFsb2dDb3JlQ29uZmlnKTtcblx0XHRcdHRoaXMuRGlhbG9nQ29yZUNvbmZpZyA9IGJhc2VTZXR0aW5ncy5EaWFsb2dDb3JlQ29uZmlnO1xuXHRcdFx0dGhpcy5CdXR0b25zICAgICAgICAgID0gZGlhbG9nQ29uZmlndXJhdG9yLnByb2R1Y3Rpb25Db25maWcuQnV0dG9ucy5zbGljZSgpO1xuXHRcdH1cblxuXHR9XG59XG4iXX0=