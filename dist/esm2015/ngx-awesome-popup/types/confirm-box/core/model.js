import { Subject } from 'rxjs';
import { map } from 'rxjs/operators';
import { GlobalClass } from '../../../core/global';
import { ServiceLocator } from '../../../locator.service';
import { ConfirmBoxConfigService } from './confirm-box-config.service';
import { ConfirmBoxService } from './confirm-box-service';
export var ConfirmBoxClass;
(function (ConfirmBoxClass) {
    // region *** Public ***
    class ConfirmBoxInitializer {
        constructor() {
            /** @internal */
            this.confirmBoxCarrier = new ConfirmBoxClass.ConfirmBoxCarrier();
        }
        openConfirmBox$() {
            return this.confirmBoxCarrier.openConfirmBox$().pipe(map(resp => {
                const basicConfirmBoxResponse = new ConfirmBoxResponse();
                const dataControl = new GlobalClass.DataControl();
                dataControl.copyValuesFrom(resp, basicConfirmBoxResponse);
                return basicConfirmBoxResponse;
            }));
        }
        setButtons(_Buttons) {
            this.confirmBoxCarrier.setButtons(_Buttons);
        }
        setConfig(_ConfirmBoxCoreConfig) {
            this.confirmBoxCarrier.setConfig(_ConfirmBoxCoreConfig);
        }
        setMessage(_Title, _Description = null) {
            this.confirmBoxCarrier.setTitle(_Title);
            this.confirmBoxCarrier.setDescription(_Description);
        }
        setTitle(_Title) {
            this.confirmBoxCarrier.setTitle(_Title);
        }
        setDescription(_Description) {
            this.confirmBoxCarrier.setDescription(_Description);
        }
        setButtonLabels(_Confirm, _Decline) {
            this.confirmBoxCarrier.setButtonLabels(_Confirm, _Decline);
        }
    }
    ConfirmBoxClass.ConfirmBoxInitializer = ConfirmBoxInitializer;
    class ConfirmBoxResponse extends GlobalClass.DataControl {
        constructor() {
            super();
            // private Response: DialogPrepareResponse            = new DialogPrepareResponse();
            this.Success = null;
            this.ClickedButtonID = null;
        }
        setSuccess(_IsSuccess) {
            this.Success = _IsSuccess;
        }
        setClickedButtonID(_ClickedButtonID) {
            this.ClickedButtonID = _ClickedButtonID;
        }
    }
    ConfirmBoxClass.ConfirmBoxResponse = ConfirmBoxResponse;
    class ConfirmBoxEventsController {
        constructor(EntityUniqueID) {
            this.EntityUniqueID = EntityUniqueID;
            this._afterClosed = new Subject();
            this.afterClosed$ = this._afterClosed.asObservable();
            this._onButtonClick = new Subject();
            this.onButtonClick$ = this._onButtonClick.asObservable();
            this._buttonList = new Subject();
            this.buttonList$ = this._buttonList.asObservable();
        }
        close(_Response) {
            const response = _Response ? _Response : this.defaultResponse;
            this._afterClosed.next(response);
        }
        onButtonClick(_Button) {
            this.defaultResponse.setClickedButtonID(_Button.ID);
            this._onButtonClick.next(_Button);
        }
        setButtonList(_ButtonList) {
            this._buttonList.next(_ButtonList);
        }
        setDefaultResponse(_Response) {
            this.defaultResponse = _Response;
        }
    }
    ConfirmBoxClass.ConfirmBoxEventsController = ConfirmBoxEventsController;
    // endregion
    class ConfirmBoxDefaultResponse extends ConfirmBoxResponse {
        constructor() {
            super();
            this.confirmBoxBelonging = null;
        }
        setBelonging(_ConfirmBoxBelonging) {
            this.confirmBoxBelonging = _ConfirmBoxBelonging;
        }
    }
    ConfirmBoxClass.ConfirmBoxDefaultResponse = ConfirmBoxDefaultResponse;
    class ConfirmBoxCarrier {
        constructor() {
            this.confirmBoxBelonging = new ConfirmBoxClass.ConfirmBoxBelonging();
        }
        setButtons(_Buttons) {
            if (_Buttons.length) {
                this.confirmBoxBelonging.Buttons = _Buttons;
            }
        }
        setTitle(_Title) {
            this.confirmBoxBelonging.Message.Title = _Title;
        }
        setDescription(_Description) {
            this.confirmBoxBelonging.Message.Description = _Description;
        }
        setButtonLabels(_Confirm, _Decline) {
            this.confirmBoxBelonging.ConfirmBoxCoreConfig.ConfirmLabel = _Confirm;
            this.confirmBoxBelonging.ConfirmBoxCoreConfig.DeclineLabel = _Decline;
        }
        setConfig(_ConfirmBoxBelonging) {
            // region *** local UserConfig (defined on place where dialog is called) ***
            const dataControl = new GlobalClass.DataControl();
            dataControl.copyValuesFrom(_ConfirmBoxBelonging, this.confirmBoxBelonging.ConfirmBoxCoreConfig);
            // endregion
        }
        openConfirmBox$() {
            const service = ServiceLocator.injector.get(ConfirmBoxService);
            const confirmBoxController = service.open(this.confirmBoxBelonging);
            return confirmBoxController.afterClosed$;
        }
    }
    ConfirmBoxClass.ConfirmBoxCarrier = ConfirmBoxCarrier;
    class Settings {
        constructor() {
            this.Buttons = [];
            this.ConfirmBoxCoreConfig = new ConfirmBoxCoreConfig();
            this.Message = new GlobalClass.Message();
        }
    }
    ConfirmBoxClass.Settings = Settings;
    class ConfirmBoxCoreConfig {
        constructor() {
            this.Width = null;
            this.Height = null;
            this.ButtonPosition = null;
            this.LayoutType = null;
            this.Message = null;
            this.ConfirmLabel = null;
            this.DeclineLabel = null;
        }
    }
    ConfirmBoxClass.ConfirmBoxCoreConfig = ConfirmBoxCoreConfig;
    class ConfirmBoxBelonging extends ConfirmBoxClass.Settings {
        constructor() {
            super();
            this.EntityUniqueID = 'C' + Math.random().toString(36).substr(2, 9);
            this.EventsController = new ConfirmBoxEventsController(this.EntityUniqueID);
            const ConfirmBoxCoreConfigurator = ServiceLocator.injector.get(ConfirmBoxConfigService);
            const baseSettings = new ConfirmBoxClass.Settings();
            const dataControl = new GlobalClass.DataControl();
            dataControl.copyValuesFrom(ConfirmBoxCoreConfigurator.productionConfig.ConfirmBoxCoreConfig, baseSettings.ConfirmBoxCoreConfig);
            this.ConfirmBoxCoreConfig = baseSettings.ConfirmBoxCoreConfig;
            this.Buttons = ConfirmBoxCoreConfigurator.productionConfig.Buttons.slice();
        }
    }
    ConfirmBoxClass.ConfirmBoxBelonging = ConfirmBoxBelonging;
})(ConfirmBoxClass || (ConfirmBoxClass = {}));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibW9kZWwuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9uZ3gtYXdlc29tZS1wb3B1cC90eXBlcy9jb25maXJtLWJveC9jb3JlL21vZGVsLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBYSxPQUFPLEVBQUMsTUFBTSxNQUFNLENBQUM7QUFDekMsT0FBTyxFQUFDLEdBQUcsRUFBQyxNQUFNLGdCQUFnQixDQUFDO0FBQ25DLE9BQU8sRUFBQyxXQUFXLEVBQWtCLE1BQU0sc0JBQXNCLENBQUM7QUFDbEUsT0FBTyxFQUFDLGNBQWMsRUFBQyxNQUFNLDBCQUEwQixDQUFDO0FBRXhELE9BQU8sRUFBQyx1QkFBdUIsRUFBQyxNQUFNLDhCQUE4QixDQUFDO0FBQ3JFLE9BQU8sRUFBQyxpQkFBaUIsRUFBQyxNQUFNLHVCQUF1QixDQUFDO0FBaUR4RCxNQUFNLEtBQVcsZUFBZSxDQW9NL0I7QUFwTUQsV0FBaUIsZUFBZTtJQUU1Qix3QkFBd0I7SUFHeEIsTUFBYSxxQkFBcUI7UUFJOUI7WUFIQSxnQkFBZ0I7WUFDUixzQkFBaUIsR0FBc0MsSUFBSSxlQUFlLENBQUMsaUJBQWlCLEVBQUUsQ0FBQztRQUd2RyxDQUFDO1FBRUQsZUFBZTtZQUNYLE9BQU8sSUFBSSxDQUFDLGlCQUFpQixDQUFDLGVBQWUsRUFBRSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLEVBQUU7Z0JBQzVELE1BQU0sdUJBQXVCLEdBQUcsSUFBSSxrQkFBa0IsRUFBRSxDQUFDO2dCQUN6RCxNQUFNLFdBQVcsR0FBZSxJQUFJLFdBQVcsQ0FBQyxXQUFXLEVBQUUsQ0FBQztnQkFDOUQsV0FBVyxDQUFDLGNBQWMsQ0FBQyxJQUFJLEVBQUUsdUJBQXVCLENBQUMsQ0FBQztnQkFDMUQsT0FBTyx1QkFBdUIsQ0FBQztZQUNuQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ1IsQ0FBQztRQUVELFVBQVUsQ0FBQyxRQUFtQztZQUMxQyxJ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QkFBMEIsR0FBNEIsY0FBYyxDQUFDLFFBQVEsQ0FBQyxHQUFHLENBQUMsdUJBQXVCLENBQUMsQ0FBQztZQUNqSCxNQUFNLFlBQVksR0FBNEMsSUFBSSxlQUFlLENBQUMsUUFBUSxFQUFFLENBQUM7WUFDN0YsTUFBTSxXQUFXLEdBQTZDLElBQUksV0FBVyxDQUFDLFdBQVcsRUFBRSxDQUFDO1lBQzVGLFdBQVcsQ0FBQyxjQUFjLENBQUMsMEJBQTBCLENBQUMsZ0JBQWdCLENBQUMsb0JBQW9CLEVBQUUsWUFBWSxDQUFDLG9CQUFvQixDQUFDLENBQUM7WUFDaEksSUFBSSxDQUFDLG9CQUFvQixHQUFHLFlBQVksQ0FBQyxvQkFBb0IsQ0FBQztZQUM5RCxJQUFJLENBQUMsT0FBTyxHQUFZLDBCQUEwQixDQUFDLGdCQUFnQixDQUFDLE9BQU8sQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUN4RixDQUFDO0tBRUo7SUFoQlksbUNBQW1CLHNCQWdCL0IsQ0FBQTtBQUdMLENBQUMsRUFwTWdCLGVBQWUsS0FBZixlQUFlLFFBb00vQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7T2JzZXJ2YWJsZSwgU3ViamVjdH0gZnJvbSAncnhqcyc7XG5pbXBvcnQge21hcH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuaW1wb3J0IHtHbG9iYWxDbGFzcywgR2xvYmFsSW50ZXJmYWNlfSBmcm9tICcuLi8uLi8uLi9jb3JlL2dsb2JhbCc7XG5pbXBvcnQge1NlcnZpY2VMb2NhdG9yfSBmcm9tICcuLi8uLi8uLi9sb2NhdG9yLnNlcnZpY2UnO1xuaW1wb3J0IHtEaWFsb2dMYXlvdXREaXNwbGF5LCBWZXJ0aWNhbFBvc2l0aW9ufSBmcm9tICcuLi8uLi8uLi9jb3JlL2VudW1zJztcbmltcG9ydCB7Q29uZmlybUJveENvbmZpZ1NlcnZpY2V9IGZyb20gJy4vY29uZmlybS1ib3gtY29uZmlnLnNlcnZpY2UnO1xuaW1wb3J0IHtDb25maXJtQm94U2VydmljZX0gZnJvbSAnLi9jb25maXJtLWJveC1zZXJ2aWNlJztcblxuZXhwb3J0IG5hbWVzcGFjZSBDb25maXJtQm94SW50ZXJmYWNlIHtcbiAgICBcbiAgICBleHBvcnQgaW50ZXJmYWNlIElDb25maXJtQm94VXNlckNvbmZpZyB7XG4gICAgICAgIEJ1dHRvbnM/OiBHbG9iYWxJbnRlcmZhY2UuSUJ1dHRvbltdO1xuICAgICAgICBDb25maXJtQm94Q29yZUNvbmZpZz86IENvbmZpcm1Cb3hJbnRlcmZhY2UuSUNvbmZpcm1Cb3hDb3JlQ29uZmlnO1xuICAgICAgICBNZXNzYWdlPzogR2xvYmFsSW50ZXJmYWNlLklNZXNzYWdlO1xuICAgIH1cbiAgICBcbiAgICBleHBvcnQgaW50ZXJmYWNlIElDb25maXJtQm94Q29yZUNvbmZpZyB7XG4gICAgICAgIC8qKiBGaXhlZCBwb3B1cCB3aWR0aCAqL1xuICAgICAgICBXaWR0aD86IHN0cmluZztcbiAgICAgICAgLyoqIEZpeGVkIHBvcHVwIGhlaWdodCAqL1xuICAgICAgICBIZWlnaHQ/OiBzdHJpbmc7XG4gICAgICAgIEJ1dHRvblBvc2l0aW9uPzogVmVydGljYWxQb3NpdGlvbjtcbiAgICAgICAgTGF5b3V0VHlwZT86IERpYWxvZ0xheW91dERpc3BsYXk7XG4gICAgICAgIE1lc3NhZ2U/OiBHbG9iYWxJbnRlcmZhY2UuSU1lc3NhZ2U7XG4gICAgICAgIENvbmZpcm1MYWJlbD86IHN0cmluZztcbiAgICAgICAgRGVjbGluZUxhYmVsPzogc3RyaW5nO1xuICAgIH1cbiAgICBcbiAgICBleHBvcnQgaW50ZXJmYWNlIElDb25maXJtQm94QmVsb25naW5nIHtcbiAgICAgICAgQnV0dG9uczogR2xvYmFsSW50ZXJmYWNlLklCdXR0b25bXTtcbiAgICAgICAgQ29uZmlybUJveENvcmVDb25maWc6IENvbmZpcm1Cb3hJbnRlcmZhY2UuSUNvbmZpcm1Cb3hDb3JlQ29uZmlnO1xuICAgICAgICBFbnRpdHlVbmlxdWVJRDogc3RyaW5nO1xuICAgICAgICBFdmVudHNDb250cm9sbGVyOiBDb25maXJtQm94Q2xhc3MuQ29uZmlybUJveEV2ZW50c0NvbnRyb2xsZXI7XG4gICAgfVxuICAgIFxuICAgIGV4cG9ydCBpbnRlcmZhY2UgSUNvbmZpcm1Cb3hSZXNwb25zZSB7XG4gICAgICAgIFxuICAgICAgICBzZXRTdWNjZXNzKF9Jc1N1Y2Nlc3M6IGJvb2xlYW4pOiB2b2lkO1xuICAgICAgICBcbiAgICAgICAgc2V0Q2xpY2tlZEJ1dHRvbklEKF9DbGlja2VkQnV0dG9uSUQpOiB2b2lkO1xuICAgICAgICBcbiAgICB9XG4gICAgXG4gICAgZXhwb3J0IGludGVyZmFjZSBJQ29uZmlybUJveFB1YmxpY1Jlc3BvbnNlIHtcbiAgICAgICAgU3VjY2VzczogYm9vbGVhbjtcbiAgICAgICAgQ2xpY2tlZEJ1dHRvbklEOiBzdHJpbmdcbiAgICB9XG4gICAgXG4gICAgZXhwb3J0IGludGVyZmFjZSBJUHJpdmF0ZVJlc3BvbnNlTWVyZ2VkIGV4dGVuZHMgSUNvbmZpcm1Cb3hSZXNwb25zZSwgR2xvYmFsSW50ZXJmYWNlLklQcml2YXRlUmVzcG9uc2Uge1xuICAgICAgICBcbiAgICAgICAgY29uZmlybUJveEJlbG9uZ2luZzogQ29uZmlybUJveEludGVyZmFjZS5JQ29uZmlybUJveEJlbG9uZ2luZztcbiAgICB9XG4gICAgXG59XG5cbmV4cG9ydCBuYW1lc3BhY2UgQ29uZmlybUJveENsYXNzIHtcbiAgICBcbiAgICAvLyByZWdpb24gKioqIFB1YmxpYyAqKipcbiAgICBcblxuICAgIGV4cG9ydCBjbGFzcyBDb25maXJtQm94SW5pdGlhbGl6ZXIge1xuICAgICAgICAvKiogQGludGVybmFsICovXG4gICAgICAgIHByaXZhdGUgY29uZmlybUJveENhcnJpZXI6IENvbmZpcm1Cb3hDbGFzcy5Db25maXJtQm94Q2FycmllciA9IG5ldyBDb25maXJtQm94Q2xhc3MuQ29uZmlybUJveENhcnJpZXIoKTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBvcGVuQ29uZmlybUJveCQoKTogT2JzZXJ2YWJsZTxDb25maXJtQm94SW50ZXJmYWNlLklDb25maXJtQm94UHVibGljUmVzcG9uc2U+IHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbmZpcm1Cb3hDYXJyaWVyLm9wZW5Db25maXJtQm94JCgpLnBpcGUobWFwKHJlc3AgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGJhc2ljQ29uZmlybUJveFJlc3BvbnNlID0gbmV3IENvbmZpcm1Cb3hSZXNwb25zZSgpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGRhdGFDb250cm9sICAgICAgICAgICAgID0gbmV3IEdsb2JhbENsYXNzLkRhdGFDb250cm9sKCk7XG4gICAgICAgICAgICAgICAgZGF0YUNvbnRyb2wuY29weVZhbHVlc0Zyb20ocmVzcCwgYmFzaWNDb25maXJtQm94UmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgIHJldHVybiBiYXNpY0NvbmZpcm1Cb3hSZXNwb25zZTtcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgc2V0QnV0dG9ucyhfQnV0dG9uczogR2xvYmFsSW50ZXJmYWNlLklCdXR0b25bXSk6IHZvaWQge1xuICAgICAgICAgICAgdGhpcy5jb25maXJtQm94Q2Fycmllci5zZXRCdXR0b25zKF9CdXR0b25zKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgc2V0Q29uZmlnKF9Db25maXJtQm94Q29yZUNvbmZpZzogQ29uZmlybUJveEludGVyZmFjZS5JQ29uZmlybUJveENvcmVDb25maWcpIHtcbiAgICAgICAgICAgIHRoaXMuY29uZmlybUJveENhcnJpZXIuc2V0Q29uZmlnKF9Db25maXJtQm94Q29yZUNvbmZpZyk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHNldE1lc3NhZ2UoX1RpdGxlOiBzdHJpbmcsIF9EZXNjcmlwdGlvbjogc3RyaW5nID0gbnVsbCk6IHZvaWQge1xuICAgICAgICAgICAgdGhpcy5jb25maXJtQm94Q2Fycmllci5zZXRUaXRsZShfVGl0bGUpO1xuICAgICAgICAgICAgdGhpcy5jb25maXJtQm94Q2Fycmllci5zZXREZXNjcmlwdGlvbihfRGVzY3JpcHRpb24pO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBzZXRUaXRsZShfVGl0bGU6IHN0cmluZyk6IHZvaWQge1xuICAgICAgICAgICAgdGhpcy5jb25maXJtQm94Q2Fycmllci5zZXRUaXRsZShfVGl0bGUpO1xuICAgICAgICB9XG4gICAgXG4gICAgICAgIHNldERlc2NyaXB0aW9uKF9EZXNjcmlwdGlvbjogc3RyaW5nKTogdm9pZCB7XG4gICAgICAgICAgICB0aGlzLmNvbmZpcm1Cb3hDYXJyaWVyLnNldERlc2NyaXB0aW9uKF9EZXNjcmlwdGlvbik7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHNldEJ1dHRvbkxhYmVscyhfQ29uZmlybTogc3RyaW5nLCBfRGVjbGluZT86IHN0cmluZyk6IHZvaWQge1xuICAgICAgICAgICAgdGhpcy5jb25maXJtQm94Q2Fycmllci5zZXRCdXR0b25MYWJlbHMoX0NvbmZpcm0sIF9EZWNsaW5lKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICB9XG4gICAgXG4gICAgZXhwb3J0IGNsYXNzIENvbmZpcm1Cb3hSZXNwb25zZSBleHRlbmRzIEdsb2JhbENsYXNzLkRhdGFDb250cm9sIGltcGxlbWVudHMgQ29uZmlybUJveEludGVyZmFjZS5JQ29uZmlybUJveFJlc3BvbnNlLCBDb25maXJtQm94SW50ZXJmYWNlLklDb25maXJtQm94UHVibGljUmVzcG9uc2Uge1xuICAgICAgICAvLyBwcml2YXRlIFJlc3BvbnNlOiBEaWFsb2dQcmVwYXJlUmVzcG9uc2UgICAgICAgICAgICA9IG5ldyBEaWFsb2dQcmVwYXJlUmVzcG9uc2UoKTtcbiAgICAgICAgXG4gICAgICAgIFN1Y2Nlc3M6IGJvb2xlYW4gICAgICAgID0gbnVsbDtcbiAgICAgICAgQ2xpY2tlZEJ1dHRvbklEOiBzdHJpbmcgPSBudWxsO1xuICAgICAgICBcbiAgICAgICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgICAgICBzdXBlcigpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBzZXRTdWNjZXNzKF9Jc1N1Y2Nlc3M6IGJvb2xlYW4pOiB2b2lkIHtcbiAgICAgICAgICAgIHRoaXMuU3VjY2VzcyA9IF9Jc1N1Y2Nlc3M7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHNldENsaWNrZWRCdXR0b25JRChfQ2xpY2tlZEJ1dHRvbklEKTogdm9pZCB7XG4gICAgICAgICAgICB0aGlzLkNsaWNrZWRCdXR0b25JRCA9IF9DbGlja2VkQnV0dG9uSUQ7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIFxuICAgIH1cbiAgICBcbiAgICBleHBvcnQgY2xhc3MgQ29uZmlybUJveEV2ZW50c0NvbnRyb2xsZXIge1xuICAgICAgICBcbiAgICAgICAgZGVmYXVsdFJlc3BvbnNlOiBDb25maXJtQm94SW50ZXJmYWNlLklQcml2YXRlUmVzcG9uc2VNZXJnZWQ7XG4gICAgICAgIFxuICAgICAgICBwcml2YXRlIHJlYWRvbmx5IF9hZnRlckNsb3NlZDogU3ViamVjdDxDb25maXJtQm94SW50ZXJmYWNlLklQcml2YXRlUmVzcG9uc2VNZXJnZWQ+ID0gbmV3IFN1YmplY3Q8Q29uZmlybUJveEludGVyZmFjZS5JUHJpdmF0ZVJlc3BvbnNlTWVyZ2VkPigpO1xuICAgICAgICBhZnRlckNsb3NlZCQ6IE9ic2VydmFibGU8Q29uZmlybUJveEludGVyZmFjZS5JUHJpdmF0ZVJlc3BvbnNlTWVyZ2VkPiAgICAgICAgICAgICAgID0gdGhpcy5fYWZ0ZXJDbG9zZWQuYXNPYnNlcnZhYmxlKCk7XG4gICAgICAgIFxuICAgICAgICBcbiAgICAgICAgcHJpdmF0ZSByZWFkb25seSBfb25CdXR0b25DbGljazogU3ViamVjdDxHbG9iYWxJbnRlcmZhY2UuSUJ1dHRvbj4gPSBuZXcgU3ViamVjdDxHbG9iYWxJbnRlcmZhY2UuSUJ1dHRvbj4oKTtcbiAgICAgICAgb25CdXR0b25DbGljayQ6IE9ic2VydmFibGU8R2xvYmFsSW50ZXJmYWNlLklCdXR0b24+ICAgICAgICAgICAgICAgPSB0aGlzLl9vbkJ1dHRvbkNsaWNrLmFzT2JzZXJ2YWJsZSgpO1xuICAgICAgICBwcml2YXRlIHJlYWRvbmx5IF9idXR0b25MaXN0OiBTdWJqZWN0PEdsb2JhbEludGVyZmFjZS5JQnV0dG9uW10+ICA9IG5ldyBTdWJqZWN0PEdsb2JhbEludGVyZmFjZS5JQnV0dG9uW10+KCk7XG4gICAgICAgIGJ1dHRvbkxpc3QkOiBPYnNlcnZhYmxlPEdsb2JhbEludGVyZmFjZS5JQnV0dG9uW10+ICAgICAgICAgICAgICAgID0gdGhpcy5fYnV0dG9uTGlzdC5hc09ic2VydmFibGUoKTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgRW50aXR5VW5pcXVlSUQ6IHN0cmluZykge1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBcbiAgICAgICAgY2xvc2UoX1Jlc3BvbnNlPzogQ29uZmlybUJveEludGVyZmFjZS5JUHJpdmF0ZVJlc3BvbnNlTWVyZ2VkKTogdm9pZCB7XG4gICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IF9SZXNwb25zZSA/IF9SZXNwb25zZSA6IHRoaXMuZGVmYXVsdFJlc3BvbnNlO1xuICAgICAgICAgICAgdGhpcy5fYWZ0ZXJDbG9zZWQubmV4dChyZXNwb25zZSk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIG9uQnV0dG9uQ2xpY2soX0J1dHRvbjogR2xvYmFsSW50ZXJmYWNlLklCdXR0b24pOiB2b2lkIHtcbiAgICAgICAgICAgIHRoaXMuZGVmYXVsdFJlc3BvbnNlLnNldENsaWNrZWRCdXR0b25JRChfQnV0dG9uLklEKTtcbiAgICAgICAgICAgIHRoaXMuX29uQnV0dG9uQ2xpY2submV4dChfQnV0dG9uKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgc2V0QnV0dG9uTGlzdChfQnV0dG9uTGlzdDogR2xvYmFsSW50ZXJmYWNlLklCdXR0b25bXSk6IHZvaWQge1xuICAgICAgICAgICAgdGhpcy5fYnV0dG9uTGlzdC5uZXh0KF9CdXR0b25MaXN0KTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgc2V0RGVmYXVsdFJlc3BvbnNlKF9SZXNwb25zZTogQ29uZmlybUJveEludGVyZmFjZS5JUHJpdmF0ZVJlc3BvbnNlTWVyZ2VkKTogdm9pZCB7XG4gICAgICAgICAgICB0aGlzLmRlZmF1bHRSZXNwb25zZSA9IF9SZXNwb25zZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvLyBlbmRyZWdpb25cbiAgICBcbiAgICBleHBvcnQgY2xhc3MgQ29uZmlybUJveERlZmF1bHRSZXNwb25zZSBleHRlbmRzIENvbmZpcm1Cb3hSZXNwb25zZSBpbXBsZW1lbnRzIENvbmZpcm1Cb3hJbnRlcmZhY2UuSVByaXZhdGVSZXNwb25zZU1lcmdlZCB7XG4gICAgICAgIGNvbmZpcm1Cb3hCZWxvbmdpbmc6IENvbmZpcm1Cb3hCZWxvbmdpbmcgPSBudWxsO1xuICAgICAgICBcbiAgICAgICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgICAgICBzdXBlcigpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBzZXRCZWxvbmdpbmcoX0NvbmZpcm1Cb3hCZWxvbmdpbmcpOiB2b2lkIHtcbiAgICAgICAgICAgIHRoaXMuY29uZmlybUJveEJlbG9uZ2luZyA9IF9Db25maXJtQm94QmVsb25naW5nO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgIH1cbiAgICBcbiAgICBleHBvcnQgY2xhc3MgQ29uZmlybUJveENhcnJpZXIge1xuICAgICAgICBcbiAgICAgICAgY29uZmlybUJveEJlbG9uZ2luZzogQ29uZmlybUJveENsYXNzLkNvbmZpcm1Cb3hCZWxvbmdpbmcgPSBuZXcgQ29uZmlybUJveENsYXNzLkNvbmZpcm1Cb3hCZWxvbmdpbmcoKTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBzZXRCdXR0b25zKF9CdXR0b25zOiBHbG9iYWxJbnRlcmZhY2UuSUJ1dHRvbltdKSB7XG4gICAgICAgICAgICBpZiAoX0J1dHRvbnMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jb25maXJtQm94QmVsb25naW5nLkJ1dHRvbnMgPSBfQnV0dG9ucztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgc2V0VGl0bGUoX1RpdGxlOiBzdHJpbmcpOiB2b2lkIHtcbiAgICAgICAgICAgIHRoaXMuY29uZmlybUJveEJlbG9uZ2luZy5NZXNzYWdlLlRpdGxlID0gX1RpdGxlO1xuICAgICAgICB9XG4gICAgXG4gICAgICAgIHNldERlc2NyaXB0aW9uKF9EZXNjcmlwdGlvbjogc3RyaW5nKTogdm9pZCB7XG4gICAgICAgICAgICB0aGlzLmNvbmZpcm1Cb3hCZWxvbmdpbmcuTWVzc2FnZS5EZXNjcmlwdGlvbiA9IF9EZXNjcmlwdGlvbjtcbiAgICAgICAgfVxuICAgIFxuICAgIFxuICAgICAgICBzZXRCdXR0b25MYWJlbHMoX0NvbmZpcm06IHN0cmluZywgX0RlY2xpbmU6IHN0cmluZyk6IHZvaWQge1xuICAgICAgICAgICAgdGhpcy5jb25maXJtQm94QmVsb25naW5nLkNvbmZpcm1Cb3hDb3JlQ29uZmlnLkNvbmZpcm1MYWJlbCA9IF9Db25maXJtO1xuICAgICAgICAgICAgdGhpcy5jb25maXJtQm94QmVsb25naW5nLkNvbmZpcm1Cb3hDb3JlQ29uZmlnLkRlY2xpbmVMYWJlbCA9IF9EZWNsaW5lO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBzZXRDb25maWcoX0NvbmZpcm1Cb3hCZWxvbmdpbmc6IENvbmZpcm1Cb3hJbnRlcmZhY2UuSUNvbmZpcm1Cb3hDb3JlQ29uZmlnKSB7XG4gICAgICAgICAgICAvLyByZWdpb24gKioqIGxvY2FsIFVzZXJDb25maWcgKGRlZmluZWQgb24gcGxhY2Ugd2hlcmUgZGlhbG9nIGlzIGNhbGxlZCkgKioqXG4gICAgICAgICAgICBjb25zdCBkYXRhQ29udHJvbCA9IG5ldyBHbG9iYWxDbGFzcy5EYXRhQ29udHJvbCgpO1xuICAgICAgICAgICAgZGF0YUNvbnRyb2wuY29weVZhbHVlc0Zyb20oX0NvbmZpcm1Cb3hCZWxvbmdpbmcsIHRoaXMuY29uZmlybUJveEJlbG9uZ2luZy5Db25maXJtQm94Q29yZUNvbmZpZyk7XG4gICAgICAgICAgICAvLyBlbmRyZWdpb25cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgb3BlbkNvbmZpcm1Cb3gkKCk6IE9ic2VydmFibGU8Q29uZmlybUJveEludGVyZmFjZS5JUHJpdmF0ZVJlc3BvbnNlTWVyZ2VkPiB7XG4gICAgICAgICAgICBjb25zdCBzZXJ2aWNlOiBDb25maXJtQm94U2VydmljZSA9IFNlcnZpY2VMb2NhdG9yLmluamVjdG9yLmdldChDb25maXJtQm94U2VydmljZSk7XG4gICAgICAgICAgICBjb25zdCBjb25maXJtQm94Q29udHJvbGxlciAgICAgICA9IHNlcnZpY2Uub3Blbih0aGlzLmNvbmZpcm1Cb3hCZWxvbmdpbmcpO1xuICAgICAgICAgICAgcmV0dXJuIGNvbmZpcm1Cb3hDb250cm9sbGVyLmFmdGVyQ2xvc2VkJDtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICB9XG4gICAgXG4gICAgZXhwb3J0IGNsYXNzIFNldHRpbmdzIHtcbiAgICAgICAgQnV0dG9uczogR2xvYmFsSW50ZXJmYWNlLklCdXR0b25bXSAgICAgICAgICAgICAgICAgICAgICA9IFtdO1xuICAgICAgICBDb25maXJtQm94Q29yZUNvbmZpZzogQ29uZmlybUJveEludGVyZmFjZS5JQ29uZmlybUJveENvcmVDb25maWcgPSBuZXcgQ29uZmlybUJveENvcmVDb25maWcoKTtcbiAgICAgICAgTWVzc2FnZTogR2xvYmFsSW50ZXJmYWNlLklNZXNzYWdlICAgICAgICAgICAgICAgICAgICAgICA9IG5ldyBHbG9iYWxDbGFzcy5NZXNzYWdlKCk7XG4gICAgfVxuICAgIFxuICAgIGV4cG9ydCBjbGFzcyBDb25maXJtQm94Q29yZUNvbmZpZyBpbXBsZW1lbnRzIENvbmZpcm1Cb3hJbnRlcmZhY2UuSUNvbmZpcm1Cb3hDb3JlQ29uZmlnIHtcbiAgICAgICAgV2lkdGg6IHN0cmluZyAgICAgICAgICAgICAgICAgICAgID0gbnVsbDtcbiAgICAgICAgSGVpZ2h0OiBzdHJpbmcgICAgICAgICAgICAgICAgICAgID0gbnVsbDtcbiAgICAgICAgQnV0dG9uUG9zaXRpb246IFZlcnRpY2FsUG9zaXRpb24gID0gbnVsbDtcbiAgICAgICAgTGF5b3V0VHlwZTogRGlhbG9nTGF5b3V0RGlzcGxheSAgID0gbnVsbDtcbiAgICAgICAgTWVzc2FnZTogR2xvYmFsSW50ZXJmYWNlLklNZXNzYWdlID0gbnVsbDtcbiAgICAgICAgQ29uZmlybUxhYmVsOiBzdHJpbmcgICAgICAgICAgICAgID0gbnVsbDtcbiAgICAgICAgRGVjbGluZUxhYmVsOiBzdHJpbmcgICAgICAgICAgICAgID0gbnVsbDtcbiAgICB9XG4gICAgXG4gICAgZXhwb3J0IGNsYXNzIENvbmZpcm1Cb3hCZWxvbmdpbmcgZXh0ZW5kcyBDb25maXJtQm94Q2xhc3MuU2V0dGluZ3MgaW1wbGVtZW50cyBDb25maXJtQm94SW50ZXJmYWNlLklDb25maXJtQm94QmVsb25naW5nIHtcbiAgICAgICAgXG4gICAgICAgIEVudGl0eVVuaXF1ZUlEOiBzdHJpbmcgPSAnQycgKyBNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHIoMiwgOSk7XG4gICAgICAgIEV2ZW50c0NvbnRyb2xsZXI6IENvbmZpcm1Cb3hFdmVudHNDb250cm9sbGVyO1xuICAgICAgICBcbiAgICAgICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgICAgICBzdXBlcigpO1xuICAgICAgICAgICAgdGhpcy5FdmVudHNDb250cm9sbGVyICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPSBuZXcgQ29uZmlybUJveEV2ZW50c0NvbnRyb2xsZXIodGhpcy5FbnRpdHlVbmlxdWVJRCk7XG4gICAgICAgICAgICBjb25zdCBDb25maXJtQm94Q29yZUNvbmZpZ3VyYXRvcjogQ29uZmlybUJveENvbmZpZ1NlcnZpY2UgPSBTZXJ2aWNlTG9jYXRvci5pbmplY3Rvci5nZXQoQ29uZmlybUJveENvbmZpZ1NlcnZpY2UpO1xuICAgICAgICAgICAgY29uc3QgYmFzZVNldHRpbmdzICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPSBuZXcgQ29uZmlybUJveENsYXNzLlNldHRpbmdzKCk7XG4gICAgICAgICAgICBjb25zdCBkYXRhQ29udHJvbCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA9IG5ldyBHbG9iYWxDbGFzcy5EYXRhQ29udHJvbCgpO1xuICAgICAgICAgICAgZGF0YUNvbnRyb2wuY29weVZhbHVlc0Zyb20oQ29uZmlybUJveENvcmVDb25maWd1cmF0b3IucHJvZHVjdGlvbkNvbmZpZy5Db25maXJtQm94Q29yZUNvbmZpZywgYmFzZVNldHRpbmdzLkNvbmZpcm1Cb3hDb3JlQ29uZmlnKTtcbiAgICAgICAgICAgIHRoaXMuQ29uZmlybUJveENvcmVDb25maWcgPSBiYXNlU2V0dGluZ3MuQ29uZmlybUJveENvcmVDb25maWc7XG4gICAgICAgICAgICB0aGlzLkJ1dHRvbnMgICAgICAgICAgPSBDb25maXJtQm94Q29yZUNvbmZpZ3VyYXRvci5wcm9kdWN0aW9uQ29uZmlnLkJ1dHRvbnMuc2xpY2UoKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICB9XG4gICAgXG4gICAgXG59XG4iXX0=